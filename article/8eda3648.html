<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":"ture","mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":"ture","trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言&amp;emsp;&amp;emsp;NoSQL(NoSQL &#x3D; Not Only SQL )，意即“不仅仅是SQL”，泛指非关系型的数据库。NoSQL 不依赖业务逻辑方式存储，而以简单的key-value模式存储。因此大大的增加了数据库的扩展能力。常用的有Memcache，Redis,MongoDB">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis学习笔记">
<meta property="og:url" content="http://example.com/article/8eda3648.html">
<meta property="og:site_name" content="无名小站">
<meta property="og:description" content="前言&amp;emsp;&amp;emsp;NoSQL(NoSQL &#x3D; Not Only SQL )，意即“不仅仅是SQL”，泛指非关系型的数据库。NoSQL 不依赖业务逻辑方式存储，而以简单的key-value模式存储。因此大大的增加了数据库的扩展能力。常用的有Memcache，Redis,MongoDB">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648457608820-18c1bbd4-02f5-47f9-a7df-c8a07674f174.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=203&id=u24c7864c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=263&originWidth=488&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23326&status=done&style=none&taskId=u0dd6c0be-6f86-4bf1-bae2-1d5748dbe30&title=&width=376">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648457838490-dde71750-8965-4cfd-8b60-7e4dbea5f457.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=271&id=u2f9d39c1&margin=%5Bobject%20Object%5D&name=image.png&originHeight=304&originWidth=547&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22162&status=done&style=none&taskId=u3b0e7fc2-bc47-4d23-9a37-426e8321988&title=&width=488">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648458313367-ec5fce37-858c-40ce-ac9a-e25064258a68.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=451&id=u9e95e2dd&margin=%5Bobject%20Object%5D&name=image.png&originHeight=579&originWidth=780&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47917&status=done&style=none&taskId=u76ee5535-82f6-4502-981b-cb28b08bfed&title=&width=608">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648460933886-4bac4c71-021a-4f11-807b-9c22076f3a82.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=519&id=u14174963&margin=%5Bobject%20Object%5D&name=image.png&originHeight=626&originWidth=590&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100799&status=done&style=none&taskId=u49a7dfee-3b92-409b-acc7-84cfd10bbce&title=&width=489">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648461565022-a852c441-bdb2-4e1c-8f82-438618bd5d18.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=448&id=u6db9dc5f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=448&originWidth=417&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23765&status=done&style=none&taskId=ucc34a6e4-a68a-4170-b34c-c811892a541&title=&width=417">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462797876-dc1e1def-8833-4928-b841-e5822bc8ec2a.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=280&id=ue67c5cf6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=280&originWidth=439&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16028&status=done&style=none&taskId=u7264a0fd-2c91-482a-979b-6b85c1dbe57&title=&width=439">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648519016984-6aa7e82f-fcea-4cce-a732-e3174005db5e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=315&id=u60f4ea82&margin=%5Bobject%20Object%5D&name=image.png&originHeight=358&originWidth=581&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22294&status=done&style=none&taskId=ucd098e30-d34a-43bf-8980-1c2fba7e8c1&title=&width=512">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462604994-d5022f3c-5a85-483f-8ec1-6a0cbf577081.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=26&id=u217af1d9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=26&originWidth=752&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3881&status=done&style=none&taskId=u93756029-f0ed-4fcc-adfa-7c27c0bcdc7&title=&width=752">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462953427-15f21bde-e77a-402d-afa4-55536f96b0ec.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=308&id=ub53e2754&margin=%5Bobject%20Object%5D&name=image.png&originHeight=474&originWidth=1043&originalType=binary&ratio=1&rotation=0&showTitle=false&size=88858&status=done&style=none&taskId=ue6ad133f-d99d-4d6d-a65f-c5082fdaa46&title=&width=677">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648519095030-25da5e72-5d5f-4097-a17a-f6bcf207eae8.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=100&id=ub25ebb18&margin=%5Bobject%20Object%5D&name=image.png&originHeight=101&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=224360&status=done&style=none&taskId=u7107cda3-361a-420e-a51f-c30d31d7f41&title=&width=547">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648520560469-71519f30-9888-43ce-b33c-79b32cd0e58d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=487&id=u868c4ca9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=487&originWidth=645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28149&status=done&style=none&taskId=u402dd7d3-1240-4e9c-800e-6145c85b3d4&title=&width=645">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648520493068-6b6cea1c-99a3-47fd-b8eb-7c2e174c213f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=58&id=u1832bc9d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=58&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=128870&status=done&style=none&taskId=u8a81997c-9f45-4a88-bba2-7faf22bbe4b&title=&width=554">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521184199-6574cb3b-3719-45ed-b9b9-972286234029.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=296&id=uc5a21500&margin=%5Bobject%20Object%5D&name=image.png&originHeight=296&originWidth=490&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16615&status=done&style=none&taskId=u4be85c96-9b90-4bfe-85c7-f8e3df187d4&title=&width=490">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521513089-22a918f0-40d3-45b9-8c94-f0b138c3115d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=389&id=u40258b4c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=389&originWidth=457&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18790&status=done&style=none&taskId=u1350487a-4bf8-4d04-82d1-88d178410d3&title=&width=457">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521751048-395f2150-3bf0-4183-9517-e1ae69f1bfc2.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=391&id=uf9334da6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=391&originWidth=731&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18238&status=done&style=none&taskId=u7e4803b7-e396-40a7-b4a8-7c430431f8f&title=&width=731">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648522491076-55012086-0f9f-425a-b8fa-d98b87bfa203.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=402&id=ue96de86c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=402&originWidth=524&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21949&status=done&style=none&taskId=u1b7eb7ad-16ba-44a6-8e02-4743770dc59&title=&width=524">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648523954231-3aa0ff19-119a-410d-94b6-0e2b464d97b4.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=378&id=ucbe1ea33&margin=%5Bobject%20Object%5D&name=image.png&originHeight=378&originWidth=508&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22850&status=done&style=none&taskId=ua3eab6bc-3bbe-4254-9ae6-0ed12502159&title=&width=508">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525104515-bf65f784-c7fd-43e2-8d89-e26e23f0b529.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=84&id=u1b86e37f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=84&originWidth=572&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4656&status=done&style=none&taskId=ue30df820-8c8f-4841-9c60-be3b8973ecb&title=&width=572">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525227289-af69111d-22dc-4d05-b5d8-25f218c2283f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=150&id=u2aa619f9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=150&originWidth=530&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9741&status=done&style=none&taskId=u0826ebb8-4321-4630-a2cf-0cefa923596&title=&width=530">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525672469-7894164b-3076-4c18-856e-16149b42c549.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=558&id=ua3956d60&margin=%5Bobject%20Object%5D&name=image.png&originHeight=558&originWidth=587&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39188&status=done&style=none&taskId=u6dc29112-0043-49e4-bb0b-4b2cd46a2ce&title=&width=587">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533519923-f3650330-4041-4b03-993a-acdb4b1b05e2.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=72&id=ub191bc65&margin=%5Bobject%20Object%5D&name=image.png&originHeight=72&originWidth=564&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5926&status=done&style=none&taskId=ud2cf7b86-a2a7-4073-833a-6f18210fd4d&title=&width=564">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533564056-aa77bd14-1ff5-4d9a-af01-ab6540a7afca.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=63&id=u7a033f99&margin=%5Bobject%20Object%5D&name=image.png&originHeight=63&originWidth=549&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4045&status=done&style=none&taskId=u50977b44-123d-4e38-88d4-467f236772c&title=&width=549">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533610290-03ef0f35-23e0-4da1-a85f-6f35c7759c73.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=115&id=u5c2eb13c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=115&originWidth=520&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7407&status=done&style=none&taskId=ue727aff0-488e-4d25-bf4a-bdf6fd975d7&title=&width=520">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533664184-252a8541-e27d-4af5-bc0a-aac12b0e3105.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=79&id=u234d9a6e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=79&originWidth=514&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4773&status=done&style=none&taskId=ud2bf6ec9-f2e0-47ad-b81b-0a3cb7d61d8&title=&width=514">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533689626-1c6008ad-a50a-49fc-b1e2-3ed2895c251b.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=78&id=uaa808f83&margin=%5Bobject%20Object%5D&name=image.png&originHeight=78&originWidth=563&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5705&status=done&style=none&taskId=ud5cfa69f-7c43-43dd-8fd8-f62065fae4c&title=&width=563">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534120632-c56be186-670b-40a3-9279-8c358546eded.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=90&id=u9843dceb&margin=%5Bobject%20Object%5D&name=image.png&originHeight=90&originWidth=577&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5377&status=done&style=none&taskId=u2709a830-bb8d-4a08-b2bc-8b5b18b24c2&title=&width=577">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534193361-d1172d97-cf99-4cce-99c1-c758988ea273.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=344&id=uc9851904&margin=%5Bobject%20Object%5D&name=image.png&originHeight=344&originWidth=556&originalType=binary&ratio=1&rotation=0&showTitle=false&size=766715&status=done&style=none&taskId=u94269cc6-53b7-4953-93a7-50eaecdf2b0&title=&width=556">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534545419-5c32c590-61fd-478b-850e-5d11ce0f70c3.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=203&id=u0fa06698&margin=%5Bobject%20Object%5D&name=image.png&originHeight=203&originWidth=315&originalType=binary&ratio=1&rotation=0&showTitle=false&size=256479&status=done&style=none&taskId=u77a96c95-6013-4907-9bb2-7bf06d1a0bb&title=&width=315">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534670935-7e78dade-1bca-4a3f-8354-d5840d047f8a.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=86&id=u659f58e6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=86&originWidth=300&originalType=binary&ratio=1&rotation=0&showTitle=false&size=103534&status=done&style=none&taskId=uf0ea182f-a581-4bb7-b103-6e6b989092b&title=&width=300">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534693116-aaf579b2-52a1-4875-b10d-54bbf18f770e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=33&id=u59326715&margin=%5Bobject%20Object%5D&name=image.png&originHeight=33&originWidth=318&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42163&status=done&style=none&taskId=u42f25462-4328-4bf8-b8ec-8b9a2775bb0&title=&width=318">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534715847-db018f58-a03e-4d16-bf3e-d67280dffb37.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=131&id=u3eff0373&margin=%5Bobject%20Object%5D&name=image.png&originHeight=131&originWidth=319&originalType=binary&ratio=1&rotation=0&showTitle=false&size=167641&status=done&style=none&taskId=u93bec09f-9ad3-46cc-95fa-76d6247d0d3&title=&width=319">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648536090968-8df066a1-c171-4531-b823-431b4595a59a.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=303&id=u294dad02&margin=%5Bobject%20Object%5D&name=image.png&originHeight=303&originWidth=649&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26899&status=done&style=none&taskId=u35ea2621-78f3-40e8-9a33-cc26ef0c939&title=&width=649">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648536716794-e38f1ddf-675f-452f-b0b6-707c9d55965e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=84&id=ubf46cc7a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=84&originWidth=425&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5456&status=done&style=none&taskId=ufa77552f-4346-4c67-af5a-c22860523e1&title=&width=425">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648537539346-6ad924d4-2907-4fa9-aa83-55a2bd8a0ef1.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=uacdacb24&margin=%5Bobject%20Object%5D&name=image.png&originHeight=175&originWidth=501&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10923&status=done&style=none&taskId=u8a5bbf9d-3d05-467b-bba1-b1960b8334f&title=&width=501">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648538207831-abceda4f-1ec4-4d09-b401-bc9d5084f70e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=261&id=uf546d35a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=261&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25417&status=done&style=none&taskId=ue42b371d-4c16-45f6-82e9-812c87d4291&title=&width=823">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648541004127-05be695c-7ac0-4d1c-9e64-05d7e9321098.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=215&id=uc349d3d5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=358&originWidth=1122&originalType=binary&ratio=1&rotation=0&showTitle=false&size=217093&status=done&style=none&taskId=u43e32814-1d7b-4c7f-9702-43a9b291909&title=&width=674">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648546629755-d91a5b55-f8a3-4d73-8b65-f448aa7a7b7d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=260&id=udb274999&margin=%5Bobject%20Object%5D&name=image.png&originHeight=260&originWidth=691&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16409&status=done&style=none&taskId=ua455d4ee-4a52-4674-9a77-ec5bd7cde0d&title=&width=691">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648546989606-9ec192e9-e2ec-4cec-8bac-d41cb4226e6f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=301&id=u8e991773&margin=%5Bobject%20Object%5D&name=image.png&originHeight=301&originWidth=552&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23403&status=done&style=none&taskId=ud540e6d0-7423-41f0-9fee-e5b15baf39d&title=&width=552">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648793686758-74a9dc77-ed8a-48c3-9d4f-b2a6ba186762.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=443&id=u972e4102&margin=%5Bobject%20Object%5D&name=image.png&originHeight=659&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62499&status=done&style=none&taskId=u6a14dd72-4920-4a4b-ba62-cbb6c9f7a74&title=&width=576">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648803770803-6b644b92-5901-452f-9e04-d79f34285aa8.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=196&id=u0e3445ab&margin=%5Bobject%20Object%5D&name=image.png&originHeight=196&originWidth=533&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32136&status=done&style=none&taskId=u22c96676-9f5a-4587-97a1-a19d242df54&title=&width=533">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648803787926-607872d4-604d-4c97-97d3-7a447cf31faf.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=257&id=ubcb01135&margin=%5Bobject%20Object%5D&name=image.png&originHeight=257&originWidth=369&originalType=binary&ratio=1&rotation=0&showTitle=false&size=380285&status=done&style=none&taskId=u23aafdde-2e05-4458-aa1c-aebe602796c&title=&width=369">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804027310-9c92d91e-ac83-4419-9231-7feaafeb43c1.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=98&id=uda0af975&margin=%5Bobject%20Object%5D&name=image.png&originHeight=98&originWidth=464&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7209&status=done&style=none&taskId=u95e5de3e-a074-44cf-aa6b-29233f09578&title=&width=464">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804129394-95f64cdf-ae2a-4b2e-bb8d-31859916f88c.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=60&id=u133be509&margin=%5Bobject%20Object%5D&name=image.png&originHeight=60&originWidth=497&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5873&status=done&style=none&taskId=ubde03a96-fbad-461b-96df-023984ca17f&title=&width=497">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804247337-11d14558-ce0d-48be-8f3b-45827744a55a.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=83&id=u89da5b15&margin=%5Bobject%20Object%5D&name=image.png&originHeight=83&originWidth=396&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7885&status=done&style=none&taskId=ue7f03418-c70a-48a3-87be-a75b55b1065&title=&width=396">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806164831-f5aad4cc-46cc-4940-83e5-d304b0afa18e.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=383&id=u2d46b0c5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=383&originWidth=234&originalType=binary&ratio=1&rotation=0&showTitle=false&size=359526&status=done&style=none&taskId=u4a2f1a76-e4d8-4ced-9fc2-7251a8c99c5&title=&width=234">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806294535-f1237e00-9ada-43d0-8a4c-2e283e0ec09b.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=107&id=uf7aa95fb&margin=%5Bobject%20Object%5D&name=image.png&originHeight=107&originWidth=578&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7669&status=done&style=none&taskId=u8d2a29b6-f466-414a-8244-bf61c16a34c&title=&width=578">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806393052-c259106c-1c01-432f-84b3-f64660de2a0e.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=75&id=u5c50bfc3&margin=%5Bobject%20Object%5D&name=image.png&originHeight=75&originWidth=422&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4304&status=done&style=none&taskId=u87f96674-eeab-4b3e-b4fc-6c17c75f23d&title=&width=422">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806502161-cb24d4fa-aea5-42e7-a490-791bde455469.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=158&id=ufa61942e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=158&originWidth=416&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9689&status=done&style=none&taskId=ua89e16c9-832d-4cd7-adae-b56fcfa671e&title=&width=416">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648807938667-2126e748-74f8-4560-bfd8-1556beb9d9af.png#clientId=ubb72c0e7-b548-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=206&id=u45e0ce81&margin=%5Bobject%20Object%5D&name=image.png&originHeight=206&originWidth=324&originalType=binary&ratio=1&rotation=0&showTitle=false&size=267690&status=done&style=none&taskId=u95e439a2-d074-4d89-9e61-3d65af6f554&title=&width=324">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648864790771-5193cde2-eae9-40f1-9185-caa2099b45e2.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=214&id=u0b197d2d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=214&originWidth=589&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25682&status=done&style=none&taskId=uab6f67f1-7d02-4a49-88cd-ca897e2dcfe&title=&width=589">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648864847245-9f1a56be-0318-41b8-b8fa-1153c4da7e2a.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=83&id=uc3b906d6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=83&originWidth=274&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3266&status=done&style=none&taskId=uc3d9ade6-b65e-4fa8-8ce9-11bd1c16a5d&title=&width=274">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865226020-01c0d6cb-819f-4c57-9d28-b1fa4bf00f34.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=162&id=u47552c63&margin=%5Bobject%20Object%5D&name=image.png&originHeight=162&originWidth=675&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16893&status=done&style=none&taskId=ua54e272b-b67f-4478-aa98-6968a9a4c2a&title=&width=675">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865630642-c901109d-6a8a-4728-9efa-36df64b9ed12.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=219&id=u5d4935dc&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13090&status=done&style=none&taskId=u39bff67a-62d4-44d5-b757-c1aad324315&title=&width=537">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865834172-4647a5b8-e0e5-4805-96bf-04d3130d1083.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=258&id=u6109724a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=258&originWidth=465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13643&status=done&style=none&taskId=u4027846e-e084-41ef-905e-4e10dc0a83c&title=&width=465">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865892851-e451bd8f-eb14-4585-914b-be1199fc22f5.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=396&id=u7d49ebb0&margin=%5Bobject%20Object%5D&name=image.png&originHeight=396&originWidth=538&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19826&status=done&style=none&taskId=u6f47634c-cded-4ab5-8f3b-61a9904f8de&title=&width=538">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648866131948-ff3accd3-ecf2-4d0b-adb3-b9454f6590e9.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=82&id=ufbdea284&margin=%5Bobject%20Object%5D&name=image.png&originHeight=82&originWidth=494&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5469&status=done&style=none&taskId=u28aff42e-6dbb-4e97-8c21-aadde9132be&title=&width=494">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648867860710-fcec0c88-bf90-49b3-8e1a-f70c8de36e9f.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=416&id=u4e112fb8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=416&originWidth=658&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29717&status=done&style=none&taskId=u2d120bab-a6d3-4e6f-bcde-9f134b0e825&title=&width=658">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648867011462-629f12e7-a5d5-4d10-96af-67e310e9ff42.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=274&id=uac553ea3&margin=%5Bobject%20Object%5D&name=03-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86.png&originHeight=620&originWidth=1376&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16292&status=done&style=none&taskId=ua7745bdd-b2b7-477e-8a28-3f9744e429a&title=&width=609">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648869827721-8a549aa3-9be1-48ba-8293-a5bd12051eed.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=47&id=u22d2826d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=47&originWidth=351&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2374&status=done&style=none&taskId=ue10552c8-497c-4cc3-b073-87518ec8019&title=&width=351">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870373239-e5e3b86d-f67e-411d-9c62-f4750068179c.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=392&id=uf8194831&margin=%5Bobject%20Object%5D&name=image.png&originHeight=493&originWidth=744&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39532&status=done&style=none&taskId=u034aef6d-be76-4726-bf83-57dc9f0a7c8&title=&width=591">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870440257-24a102d3-7ae4-48e6-bde0-ee1afed59c1b.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=110&id=u495eae2d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=152&originWidth=831&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21748&status=done&style=none&taskId=uddc6606b-22b9-4ebb-98b1-68913267e8b&title=&width=601">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870561523-ca2cb646-d128-4044-b0ce-62dd107dc1c2.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=99&id=u5ed9eb70&margin=%5Bobject%20Object%5D&name=image.png&originHeight=99&originWidth=396&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7206&status=done&style=none&taskId=u0d50d801-28d8-4e55-b062-54cc322f9f4&title=&width=396">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870600742-738209a7-f940-41a0-9d8e-a79580832251.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=301&id=ue6642fe4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=301&originWidth=553&originalType=binary&ratio=1&rotation=0&showTitle=false&size=667274&status=done&style=none&taskId=u2d27035b-1a8f-4929-8c1e-13f622f3eca&title=&width=553">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648881347666-50c01f5d-7320-4e88-b1e1-6416ef886b93.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=122&id=ua2da2993&margin=%5Bobject%20Object%5D&name=image.png&originHeight=122&originWidth=469&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9955&status=done&style=none&taskId=ub80c11bd-4456-4b49-9187-eb50cedf0af&title=&width=469">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648882425234-c00473d6-c3b2-4037-b323-0ae4dbc4e07c.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=609&id=u14d269c2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=833&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=94542&status=done&style=none&taskId=uaed59558-5cc9-4b19-a071-79f50050c2d&title=&width=626">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648883985300-e0c6238c-a442-439b-bbf8-b1f79450993d.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=161&id=uc986db01&margin=%5Bobject%20Object%5D&name=image.png&originHeight=195&originWidth=841&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26301&status=done&style=none&taskId=u46307eb6-81e5-4e34-9364-286a1334962&title=&width=693">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648884358614-be6e4902-bec8-4a61-9154-c37011a947db.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=155&id=ua306757e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=192&originWidth=833&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25162&status=done&style=none&taskId=ub1f1cced-1c7c-4a04-aa2b-0284d5736d7&title=&width=673">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648885122084-1b58ef27-cd6f-44c0-a774-9725f06c7f2c.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=190&id=uc8a087c2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=200&originWidth=714&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29121&status=done&style=none&taskId=u62798e80-753d-47bc-9472-2d6ff90476e&title=&width=680">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648889837952-f37ea733-8c31-43e0-aab4-e5b845830fd7.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=47&id=u340bd26b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=47&originWidth=450&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3066&status=done&style=none&taskId=uc6ed2201-a3c8-482e-9ee6-97ddfd2613d&title=&width=450">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648889875481-b38a1d94-1ca0-4f57-a309-f6e80745b95f.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=417&id=u7ee5abd8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=590&originWidth=910&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28974&status=done&style=none&taskId=u0b238606-276b-42dd-94b3-c6a1eb3e475&title=&width=643">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648892822303-1ce42d79-cc84-4b6e-bd89-fe47155a73c2.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9665&crop=0.76&from=paste&height=684&id=uacf2ffcc&margin=%5Bobject%20Object%5D&name=05-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=160487&status=done&style=none&taskId=u68bc1b0c-ea54-46dd-b44b-a847e7b2435&title=&width=1332">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893220437-6176781f-ce6a-4d27-8331-1a2067679453.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=402&id=u042b964e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=402&originWidth=507&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44641&status=done&style=none&taskId=u0a04b37d-a502-43af-ac8b-d02f15f79dd&title=&width=507">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893598495-090f292e-69ba-4806-91fd-52586992d67d.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9651&crop=0.6947&from=paste&height=683&id=ua13034fb&margin=%5Bobject%20Object%5D&name=06-%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=120604&status=done&style=none&taskId=ua71b13f7-b9c1-43d4-ba3e-69554e7e44f&title=&width=1330">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893676537-013ce44b-4380-4a8f-9795-5a5b0e45fb32.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=707&id=u55c7c011&margin=%5Bobject%20Object%5D&name=image.png&originHeight=707&originWidth=605&originalType=binary&ratio=1&rotation=0&showTitle=false&size=75907&status=done&style=none&taskId=u868e97ac-6f4a-49d8-a785-d4cb83d90de&title=&width=605">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893937035-1bd8a984-bc88-4492-a2c2-50a6533c0cf5.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9397&crop=0.7548&from=paste&height=665&id=ufa498b1c&margin=%5Bobject%20Object%5D&name=07-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=141331&status=done&style=none&taskId=u647c8675-2938-4b38-84d6-0ee8f944afd&title=&width=1295">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648894033964-28b6eaf3-de5b-4733-a6d1-b31b86ad5dd3.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=336&id=udb77d739&margin=%5Bobject%20Object%5D&name=image.png&originHeight=336&originWidth=505&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32200&status=done&style=none&taskId=u1e8764df-5124-4a8a-ba46-2d7ec44187a&title=&width=505">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1649234227386-5101822b-2579-485a-8aa9-8853d795db6c.png#clientId=u5b6aea5e-c01f-4&crop=0.0383&crop=0.0507&crop=0.9463&crop=0.8657&from=paste&height=304&id=u1cf2839a&margin=%5Bobject%20Object%5D&name=09-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88UUID%E9%98%B2%E8%AF%AF%E5%88%A0%EF%BC%89.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23787&status=done&style=none&taskId=u068be09a-20eb-40c9-9108-43229861f28&title=&width=592">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1649234773183-aa5734eb-e8eb-40b4-99b1-7442f3852f9f.png#clientId=u5b6aea5e-c01f-4&crop=0&crop=0&crop=0.7413&crop=0.8669&from=paste&height=525&id=u605a56a3&margin=%5Bobject%20Object%5D&name=10-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%EF%BC%89.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17460&status=done&style=none&taskId=ub5c44e66-d385-4f8f-9927-fc6d9f9842b&title=&width=1021">
<meta property="article:published_time" content="2022-04-17T07:33:33.000Z">
<meta property="article:modified_time" content="2022-04-17T07:35:06.917Z">
<meta property="article:author" content="Jie">
<meta property="article:tag" content="springboot">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648457608820-18c1bbd4-02f5-47f9-a7df-c8a07674f174.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=203&id=u24c7864c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=263&originWidth=488&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23326&status=done&style=none&taskId=u0dd6c0be-6f86-4bf1-bae2-1d5748dbe30&title=&width=376">

<link rel="canonical" href="http://example.com/article/8eda3648.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Redis学习笔记 | 无名小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="无名小站" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">无名小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-links">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/article/8eda3648.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/author.jpg">
      <meta itemprop="name" content="Jie">
      <meta itemprop="description" content="以后这样的事还多着呢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="无名小站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis学习笔记
        </h1>

        <div class="post-meta">

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-04-17 15:33:33 / 修改时间：15:35:06" itemprop="dateCreated datePublished" datetime="2022-04-17T15:33:33+08:00">2022-04-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

         
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
         
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">评论数：</span>
    
    <a title="valine" href="/article/8eda3648.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/article/8eda3648.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>18 分钟</span>
            </span>

          
            <span id="/article/8eda3648.html" class="post-meta-item leancloud_visitors" data-flag-title="Redis学习笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>&emsp;&emsp;NoSQL(NoSQL = <strong>Not Only SQL</strong> )，意即“不仅仅是SQL”，泛指<strong>非关系型的数据库</strong>。NoSQL 不依赖业务逻辑方式存储，而以简单的key-value模式存储。因此大大的增加了数据库的扩展能力。常用的有Memcache，Redis,MongoDB</p>
<span id="more"></span>
<p><a name="MQgVJ"></a></p>
<h1 id="NoSQL数据库"><a href="#NoSQL数据库" class="headerlink" title="NoSQL数据库"></a>NoSQL数据库</h1><p><a name="ht0tJ"></a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>NoSQL(NoSQL = <strong>Not Only SQL</strong> )，意即“不仅仅是SQL”，泛指<strong>非关系型的数据库</strong>。<br />NoSQL 不依赖业务逻辑方式存储，而以简单的key-value模式存储。因此大大的增加了数据库的扩展能力。常用的有Memcache，Redis,MongoDB</p>
<ul>
<li><p> 不遵循SQL标准。</p>
</li>
<li><p>不支持ACID。</p>
</li>
<li><p>远超于SQL的性能。<br><a name="yNkn5"></a></p>
<h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3></li>
<li><p>对数据高并发的读写</p>
</li>
<li><p>海量数据的读写</p>
</li>
<li><p>对数据高可扩展性的<br><a name="wNVQU"></a></p>
<h3 id="不适用场景"><a href="#不适用场景" class="headerlink" title="不适用场景"></a>不适用场景</h3></li>
<li><p>需要事务支持</p>
</li>
<li><p>基于sql的结构化查询存储，处理复杂的关系,需要即席查询。</p>
</li>
<li><p>（用不着sql的和用了sql也不行的情况，请考虑用NoSql）</p>
</li>
</ul>
<p><a name="DpIxp"></a></p>
<h1 id="Redis概述安装"><a href="#Redis概述安装" class="headerlink" title="Redis概述安装"></a>Redis概述安装</h1><ol>
<li>安装步骤<ul>
<li>需要先安装gcc：<code>yum install gcc</code>（gcc –version命令判断有无安装）</li>
<li>到下载文件目录执行以下命令</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648457608820-18c1bbd4-02f5-47f9-a7df-c8a07674f174.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=203&id=u24c7864c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=263&originWidth=488&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23326&status=done&style=none&taskId=u0dd6c0be-6f86-4bf1-bae2-1d5748dbe30&title=&width=376" alt="image.png"></li>
<li>make install安装结束</li>
</ul>
</li>
<li>安装默认文件目录及对应组件作用</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648457838490-dde71750-8965-4cfd-8b60-7e4dbea5f457.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=271&id=u2f9d39c1&margin=%5Bobject%20Object%5D&name=image.png&originHeight=304&originWidth=547&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22162&status=done&style=none&taskId=u3b0e7fc2-bc47-4d23-9a37-426e8321988&title=&width=488" alt="image.png"></p>
<ol start="3">
<li>启动redis服务<ol>
<li>前台启动（不推荐）</li>
</ol>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648458313367-ec5fce37-858c-40ce-ac9a-e25064258a68.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=451&id=u9e95e2dd&margin=%5Bobject%20Object%5D&name=image.png&originHeight=579&originWidth=780&originalType=binary&ratio=1&rotation=0&showTitle=false&size=47917&status=done&style=none&taskId=u76ee5535-82f6-4502-981b-cb28b08bfed&title=&width=608" alt="image.png"><br />不推荐使用，离开这个页面就会自动关闭（CTRL+c手动关闭）</p>
<ol start="2">
<li>后台启动<ul>
<li>默认不支持后台启动，设置如下</li>
<li>复制redis.conf文件到其他目录 <code>cp redis.conf /etc/redis.conf</code></li>
<li>修改复制到新目录的redis.conf <code>vi redis.conf</code><strong>后台启动设置daemonize no改成yes</strong></li>
<li>重新回到usr/local/bin目录下启动 <code>redis-server /etc/redis.conf</code>    </li>
<li>客户端访问命令<code>redis-cli</code>(redis-cli -p6379）</li>
<li>查看redis相关端口<code>ps -ef|grep redis</code></li>
</ul>
</li>
<li>关闭服务<ol>
<li>单实例<code>redis-cli shutdown</code></li>
<li>多实例关闭，指定端口关闭：<code>redis-cli -p 6379 shutdown</code></li>
<li>进入终端直接shutdown</li>
<li>查看服务然后，kill pid</li>
</ol>
</li>
<li>相关知识</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648460933886-4bac4c71-021a-4f11-807b-9c22076f3a82.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=519&id=u14174963&margin=%5Bobject%20Object%5D&name=image.png&originHeight=626&originWidth=590&originalType=binary&ratio=1&rotation=0&showTitle=false&size=100799&status=done&style=none&taskId=u49a7dfee-3b92-409b-acc7-84cfd10bbce&title=&width=489" alt="image.png"><br><a name="vURfD"></a></p>
<h1 id="常用数据类型"><a href="#常用数据类型" class="headerlink" title="常用数据类型"></a>常用数据类型</h1><p><a name="CkZty"></a></p>
<h2 id="key相关命令操作"><a href="#key相关命令操作" class="headerlink" title="key相关命令操作"></a>key相关命令操作</h2><ul>
<li>keys *查看当前库所有key    (匹配：keys *1)</li>
<li>exists key判断某个key是否存在</li>
<li>type key 查看你的key是什么类型</li>
<li>del key       删除指定的key数据</li>
<li>unlink key   根据value选择非阻塞删除</li>
<li>仅将keys从keyspace元数据中删除，真正的删除会在后续异步操作。</li>
<li>expire key 10   10秒钟：为给定的key设置过期时间</li>
<li>ttl key 查看还有多少秒过期，-1表示永不过期，-2表示已过期</li>
</ul>
<p>其他命令</p>
<ul>
<li>select命令切换数据库</li>
<li>dbsize查看当前数据库的key的数量</li>
<li>flushdb清空当前库</li>
<li>flushall通杀全部库</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648461565022-a852c441-bdb2-4e1c-8f82-438618bd5d18.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=448&id=u6db9dc5f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=448&originWidth=417&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23765&status=done&style=none&taskId=ucc34a6e4-a68a-4170-b34c-c811892a541&title=&width=417" alt="image.png"><br><a name="zq9K6"></a></p>
<h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><ol>
<li>String是Redis最基本的类型，一个key对应一个value。</li>
</ol>
<p>String类型是二进制安全的。Redis的string可以包含任何数据。比如jpg图片或者序列化的对象。<br />String类型是Redis最基本的数据类型，一个Redis中字符串value最多可以是512M</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>set   <key><value>添加键值对</li>
<li>get   <key>查询对应键值</li>
<li>append  <key><value>将给定的<value> 追加到原值的末尾</li>
<li>strlen  <key>获得值的长度</li>
<li>setnx  <key><value>只有在 key 不存在时    设置 key 的值</li>
<li>incr  <key></li>
<li>将key 中储存的数字值增1</li>
<li>只能对数字值操作，如果为空，新增值为1</li>
<li>decr  <key>将key 中储存的数字值减1；只能对数字值操作，如果为空，新增值为-1</li>
<li>incrby / decrby  <key>&lt;步长&gt;将key 中储存的数字值增减。自定义步长。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462797876-dc1e1def-8833-4928-b841-e5822bc8ec2a.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=280&id=ue67c5cf6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=280&originWidth=439&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16028&status=done&style=none&taskId=u7264a0fd-2c91-482a-979b-6b85c1dbe57&title=&width=439" alt="image.png"></li>
<li>mset  <key1><value1><key2><value2>  ….. 同时设置一个或多个key-value对  </li>
<li>mget  <key1><key2><key3> …..同时获取一个或多个value  </li>
<li>msetnx <key1><value1><key2><value2>  ….. 同时设置一个或多个key-value 对，当且仅当所有给定 key 都不存在。<strong>原子性，有一个失败则都失败</strong></li>
<li>getrange  <key>&lt;起始位置&gt;&lt;结束位置&gt;获得值的范围，类似java中的substring，<strong>前包，后包</strong></li>
<li>setrange  <key>&lt;起始位置&gt;<value>用<value>  覆写<key>所储存的字符串值，从&lt;起始位置&gt;开始**(索引从0开始)。**</li>
<li>setex  <key>&lt;过期时间&gt;<value>设置键值的同时，设置过期时间，单位秒。</li>
<li>getset <key><value>以新换旧，设置了新值同时获得旧值。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648519016984-6aa7e82f-fcea-4cce-a732-e3174005db5e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=315&id=u60f4ea82&margin=%5Bobject%20Object%5D&name=image.png&originHeight=358&originWidth=581&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22294&status=done&style=none&taskId=ucd098e30-d34a-43bf-8980-1c2fba7e8c1&title=&width=512" alt="image.png"></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462604994-d5022f3c-5a85-483f-8ec1-6a0cbf577081.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=26&id=u217af1d9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=26&originWidth=752&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3881&status=done&style=none&taskId=u93756029-f0ed-4fcc-adfa-7c27c0bcdc7&title=&width=752" alt="image.png"><br />set时候后面可选参数</p>
<ul>
<li>*NX：当数据库中key不存在时，可以将key-value添加数据库</li>
<li>*XX：当数据库中key存在时，可以将key-value添加数据库，与NX参数互斥</li>
<li>*EX：key的超时秒数</li>
<li>*PX：key的超时毫秒数，与EX互斥</li>
</ul>
<p>注意：redis中的操作均是<strong>原子操作</strong>，因为redis本身就是<strong>单线程</strong>的；Java中不是原子操作<br />有意思的示例：<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648462953427-15f21bde-e77a-402d-afa4-55536f96b0ec.png#clientId=udc7b9c96-2f46-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=308&id=ub53e2754&margin=%5Bobject%20Object%5D&name=image.png&originHeight=474&originWidth=1043&originalType=binary&ratio=1&rotation=0&showTitle=false&size=88858&status=done&style=none&taskId=ue6ad133f-d99d-4d6d-a65f-c5082fdaa46&title=&width=677" alt="image.png"></p>
<ol start="3">
<li>数据结构</li>
</ol>
<p>类似于Java中的arraylist;<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648519095030-25da5e72-5d5f-4097-a17a-f6bcf207eae8.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=100&id=ub25ebb18&margin=%5Bobject%20Object%5D&name=image.png&originHeight=101&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=224360&status=done&style=none&taskId=u7107cda3-361a-420e-a51f-c30d31d7f41&title=&width=547" alt="image.png"><br />如图中所示，内部为当前字符串实际分配的空间capacity一般要高于实际字符串长度len。当字符串长度小于1M时，扩容都是加倍现有的空间，如果超过1M，扩容时一次只会多扩1M的空间。需要注意的是字符串最大长度为512M。</p>
<p><a name="OyFTP"></a></p>
<h2 id="list"><a href="#list" class="headerlink" title="list"></a>list</h2><ol>
<li>简介</li>
</ol>
<p>单键多值，底层为一个双向列表，可从两端插入数据，根据插入数据排序。</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>lpush/rpush  <key><value1><value2><value3> …. 从左边/右边插入一个或多个值。</li>
<li>lpop/rpop  <key>从左边/右边吐出一个值。<strong>值在键在，值光键亡。</strong></li>
<li>rpoplpush  <key1><key2>从<key1>列表右边吐出一个值，插到<key2>列表左边。</li>
</ul>
<p><strong>改成lpoprpush不行</strong></p>
<ul>
<li>lrange <key><start><stop>按照索引下标获得元素(从左到右)（<strong>0-1表示获取所有</strong>）</li>
<li>lindex <key><index>按照索引下标获得元素(从左到右)</li>
<li>llen <key>获得列表长度 </li>
<li>linsert <key>  before <value><newvalue>在<value>的后面插入<newvalue>插入值</li>
<li>lrem <key><n><value>从左边删除n个value(从左到右)</li>
<li>lset<key><index><value>将列表key下标为index的值替换成value</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648520560469-71519f30-9888-43ce-b33c-79b32cd0e58d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=487&id=u868c4ca9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=487&originWidth=645&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28149&status=done&style=none&taskId=u402dd7d3-1240-4e9c-800e-6145c85b3d4&title=&width=645" alt="image.png"></li>
</ul>
<ol start="3">
<li>数据结构</li>
</ol>
<p>List的数据结构为<strong>快速链表quickList</strong>。<br />首先在列表元素较少的情况下会使用一块连续的内存存储，这个结构是ziplist，也即是压缩列表。<br />它将所有的元素紧挨着一起存储，分配的是一块连续的内存。<br />当数据量比较多的时候才会改成quicklist。<br />因为普通的链表需要的附加指针空间太大，会比较浪费空间。比如这个列表里存的只是int类型的数据，结构上还需要两个额外的指针prev和next。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648520493068-6b6cea1c-99a3-47fd-b8eb-7c2e174c213f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=58&id=u1832bc9d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=58&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=128870&status=done&style=none&taskId=u8a81997c-9f45-4a88-bba2-7faf22bbe4b&title=&width=554" alt="image.png"><br /><strong>Redis将链表和ziplist结合起来组成了quicklist。也就是将多个ziplist使用双向指针串起来使用</strong>。这样既满足了快速的插入删除性能，又不会出现太大的空间冗余。<br><a name="dnT1x"></a></p>
<h2 id="set"><a href="#set" class="headerlink" title="set"></a>set</h2><ol>
<li>简介</li>
</ol>
<p>可以看作没有重复值的list；并且set提供判断一个值是否存在于key中</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>sadd <key><value1><value2> ….. 将一个或多个member 元素加入到集合 key 中，已经存在的member 元素将被忽略</li>
<li>smembers <key>查看该集合的所有值。</li>
<li>sismember <key><value>判断集合<key>是否为含有该<value>值，有1，没有0</li>
<li>scard<key>返回该集合的元素个数。</li>
<li>srem <key><value1><value2> …. 删除集合中的指定元素。</li>
<li>spop <key>随机从该集合中吐出一个值，<strong>并将其删除</strong>。</li>
<li>srandmember <key><n>随机从该集合中取出n个值。<strong>不会从集合中删除</strong> 。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521184199-6574cb3b-3719-45ed-b9b9-972286234029.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=296&id=uc5a21500&margin=%5Bobject%20Object%5D&name=image.png&originHeight=296&originWidth=490&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16615&status=done&style=none&taskId=u4be85c96-9b90-4bfe-85c7-f8e3df187d4&title=&width=490" alt="image.png">     </li>
<li>smove <source><destination>value把集合中一个值从一个集合移动到另一个集合</li>
<li>sinter <key1><key2>返回两个集合的交集元素。</li>
<li>sunion <key1><key2>返回两个集合的并集元素。</li>
<li>sdiff <key1><key2>返回两个集合的差集元素(key1中的，不包含key2中的)</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521513089-22a918f0-40d3-45b9-8c94-f0b138c3115d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=389&id=u40258b4c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=389&originWidth=457&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18790&status=done&style=none&taskId=u1350487a-4bf8-4d04-82d1-88d178410d3&title=&width=457" alt="image.png"></li>
</ul>
<ol start="3">
<li>数据结构</li>
</ol>
<p>Set数据结构是dict字典，字典是用<strong>哈希表实现的</strong>。<br />Java中HashSet的内部实现使用的是HashMap，只不过所有的value都指向同一个对象。Redis的set结构也是一样，它的内部也使用hash结构，所有的value都指向同一个内部值。</p>
<p><a name="h3aln"></a></p>
<h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><ol>
<li>简介</li>
</ol>
<p>hash就相当于键值对的集合，适合存储对象，key为字符串，value为键值对集合；类似于Java中的map，如下图所示<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648521751048-395f2150-3bf0-4183-9517-e1ae69f1bfc2.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=391&id=uf9334da6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=391&originWidth=731&originalType=binary&ratio=1&rotation=0&showTitle=false&size=18238&status=done&style=none&taskId=u7e4803b7-e396-40a7-b4a8-7c430431f8f&title=&width=731" alt="image.png"></p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>hset <key><field><value>给<key>集合中的  <field>键赋值<value></li>
<li>hget <key1><field>从<key1>集合<field>取出value </li>
<li>hmset <key1><field1><value1><field2><value2>… <strong>批量设置hash的值</strong></li>
<li>hexists<key1><field>查看哈希表 key 中，给定域 field 是否存在。</li>
<li>hkeys <key>列出该hash集合的所有field</li>
<li>hvals <key>列出该hash集合的所有value</li>
<li>hincrby <key><field><increment>为哈希表 key 中的域 field 的值加上增量1   -1</li>
<li>hsetnx <key><field><value>将哈希表 key 中的域 field 的值设置为value ，<strong>当且仅当域field 不存在.</strong></li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648522491076-55012086-0f9f-425a-b8fa-d98b87bfa203.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=402&id=ue96de86c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=402&originWidth=524&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21949&status=done&style=none&taskId=u1b7eb7ad-16ba-44a6-8e02-4743770dc59&title=&width=524" alt="image.png"></li>
</ul>
<ol start="3">
<li>数据结构</li>
</ol>
<p>Hash类型对应的数据结构是两种：ziplist（压缩列表），hashtable（哈希表）。当field-value长度较短且个数较少时，使用ziplist，否则使用hashtable。<br><a name="f6SyH"></a></p>
<h2 id="zset"><a href="#zset" class="headerlink" title="zset"></a>zset</h2><ol>
<li>简介</li>
</ol>
<p>zset就是一个有序的set，实现可以理解为hash，不过添加了一个score，来根据这个score的大小进行排序。</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>zadd  <key><score1><value1><score2><value2>…将一个或多个member 元素及其 score 值加入到有序集key 当中。</li>
<li>zrange <key><start><stop>  [WITHSCORES]   返回有序集key 中，下标在<start><stop>之间的元素（0，-1全部返回）带WITHSCORES，可以让分数一起和值返回到结果集。</li>
<li>zrangebyscore key [withscores] [limit offset count]返回有序集key 中，所有 score 值介于min 和max 之间(包括等于min 或max )的成员。有序集成员按score 值递增**(从小到大**)次序排列。</li>
<li>z<strong>rev</strong>rangebyscore key [withscores] [limit offset count]  同上，改为<strong>从大到小</strong>排列。</li>
<li>zincrby <key><increment><value>      为元素的score加上增量</li>
<li>zrem  <key><value>删除该集合下，指定值的元素 </li>
<li>zcount <key><min><max>统计该集合，分数区间内的元素个数 </li>
<li>zrank <key><value>返回该值在集合中的排名，从0开始。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648523954231-3aa0ff19-119a-410d-94b6-0e2b464d97b4.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=378&id=ucbe1ea33&margin=%5Bobject%20Object%5D&name=image.png&originHeight=378&originWidth=508&originalType=binary&ratio=1&rotation=0&showTitle=false&size=22850&status=done&style=none&taskId=ua3eab6bc-3bbe-4254-9ae6-0ed12502159&title=&width=508" alt="image.png"></li>
</ul>
<ol start="3">
<li>数据结构</li>
</ol>
<p>SortedSet(zset)是Redis提供的一个非常特别的数据结构，一方面它等价于Java的数据结构        Map&lt;String, Double&gt;，可以给每一个元素value赋予一个权重score，另一方面它又类似于TreeSet，内部的元素会按照权重score进行排序，可以得到每个元素的名次，还可以通过score的范围来获取元素的列表。<br />zset底层使用了两个数据结构<br />（1）hash，hash的作用就是关联元素value和权重score，保障元素value的唯一性，可以通过元素value找到相应的score值。<br />（2）跳跃表，跳跃表的目的在于给元素value排序，根据score的范围获取元素列表。</p>
<p><a name="so8Mb"></a></p>
<h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><ol>
<li>网络相关配置</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525104515-bf65f784-c7fd-43e2-8d89-e26e23f0b529.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=84&id=u1b86e37f&margin=%5Bobject%20Object%5D&name=image.png&originHeight=84&originWidth=572&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4656&status=done&style=none&taskId=ue30df820-8c8f-4841-9c60-be3b8973ecb&title=&width=572" alt="image.png"><br />默认只接受本机访问，不写则不限则；<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525227289-af69111d-22dc-4d05-b5d8-25f218c2283f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=150&id=u2aa619f9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=150&originWidth=530&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9741&status=done&style=none&taskId=u0826ebb8-4321-4630-a2cf-0cefa923596&title=&width=530" alt="image.png"><br />生产环境要写应用服务器的地址；服务器是需要远程访问的，所以需要将<strong>bind</strong>注释掉，并且<strong>protected-mode no</strong>(本机保护模式，这个代表只接受本机访问）<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648525672469-7894164b-3076-4c18-856e-16149b42c549.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=558&id=ua3956d60&margin=%5Bobject%20Object%5D&name=image.png&originHeight=558&originWidth=587&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39188&status=done&style=none&taskId=u6dc29112-0043-49e4-bb0b-4b2cd46a2ce&title=&width=587" alt="image.png">\</p>
<ul>
<li>设置tcp的backlog，backlog其实是一个连接队列，backlog队列总和=未完成三次握手队列+ 已经完成三次握手队列。</li>
<li>timeout 一个空闲的客户端维持多少秒会关闭，0表示关闭该功能。即永不关闭。</li>
<li>tcp keepalive对访问客户端的一种心跳检测，每个n秒检测一次。单位为秒，如果设置为0，则不会进行Keepalive检测，建议设置成60 </li>
</ul>
<ol start="2">
<li>通用设置</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533519923-f3650330-4041-4b03-993a-acdb4b1b05e2.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=72&id=ub191bc65&margin=%5Bobject%20Object%5D&name=image.png&originHeight=72&originWidth=564&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5926&status=done&style=none&taskId=ud2cf7b86-a2a7-4073-833a-6f18210fd4d&title=&width=564" alt="image.png"><br />后台启动<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533564056-aa77bd14-1ff5-4d9a-af01-ab6540a7afca.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=63&id=u7a033f99&margin=%5Bobject%20Object%5D&name=image.png&originHeight=63&originWidth=549&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4045&status=done&style=none&taskId=u50977b44-123d-4e38-88d4-467f236772c&title=&width=549" alt="image.png"><br />存放pid文件的位置·，每个实例不同pid文件<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533610290-03ef0f35-23e0-4da1-a85f-6f35c7759c73.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=115&id=u5c2eb13c&margin=%5Bobject%20Object%5D&name=image.png&originHeight=115&originWidth=520&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7407&status=done&style=none&taskId=ue727aff0-488e-4d25-bf4a-bdf6fd975d7&title=&width=520" alt="image.png"><br />日志级别设置：指定日志记录级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为<strong>notice；</strong>四个级别根据使用阶段来选择，生产环境选择notice 或者warning<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533664184-252a8541-e27d-4af5-bc0a-aac12b0e3105.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=79&id=u234d9a6e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=79&originWidth=514&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4773&status=done&style=none&taskId=ud2bf6ec9-f2e0-47ad-b81b-0a3cb7d61d8&title=&width=514" alt="image.png"><br />日志文件存放位置<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648533689626-1c6008ad-a50a-49fc-b1e2-3ed2895c251b.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=78&id=uaa808f83&margin=%5Bobject%20Object%5D&name=image.png&originHeight=78&originWidth=563&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5705&status=done&style=none&taskId=ud5cfa69f-7c43-43dd-8fd8-f62065fae4c&title=&width=563" alt="image.png"><br />数据库数目，默认16个</p>
<ol start="3">
<li>密码设置</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534120632-c56be186-670b-40a3-9279-8c358546eded.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=90&id=u9843dceb&margin=%5Bobject%20Object%5D&name=image.png&originHeight=90&originWidth=577&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5377&status=done&style=none&taskId=u2709a830-bb8d-4a08-b2bc-8b5b18b24c2&title=&width=577" alt="image.png"><br />设置密码<br />在命令中设置密码，只是临时的。重启redis服务器，密码就还原了。<br />永久设置，需要再配置文件中进行设置。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534193361-d1172d97-cf99-4cce-99c1-c758988ea273.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=344&id=uc9851904&margin=%5Bobject%20Object%5D&name=image.png&originHeight=344&originWidth=556&originalType=binary&ratio=1&rotation=0&showTitle=false&size=766715&status=done&style=none&taskId=u94269cc6-53b7-4953-93a7-50eaecdf2b0&title=&width=556" alt="image.png"></p>
<p><a name="V7LQN"></a></p>
<h1 id="Redis中的发布和订阅"><a href="#Redis中的发布和订阅" class="headerlink" title="Redis中的发布和订阅"></a>Redis中的发布和订阅</h1><ol>
<li>概念</li>
</ol>
<p>Redis 发布订阅 (pub/sub) 是一种消息通信模式：发送者 (pub) 发送消息，订阅者 (sub) 接收消息。<br />Redis 客户端可以订阅任意数量的频道。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534545419-5c32c590-61fd-478b-850e-5d11ce0f70c3.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=203&id=u0fa06698&margin=%5Bobject%20Object%5D&name=image.png&originHeight=203&originWidth=315&originalType=binary&ratio=1&rotation=0&showTitle=false&size=256479&status=done&style=none&taskId=u77a96c95-6013-4907-9bb2-7bf06d1a0bb&title=&width=315" alt="image.png"></p>
<ol start="2">
<li>命令实现</li>
</ol>
<ul>
<li>打开一个客户端订阅channel1  <code>SUBSCRIBE channel1</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534670935-7e78dade-1bca-4a3f-8354-d5840d047f8a.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=86&id=u659f58e6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=86&originWidth=300&originalType=binary&ratio=1&rotation=0&showTitle=false&size=103534&status=done&style=none&taskId=uf0ea182f-a581-4bb7-b103-6e6b989092b&title=&width=300" alt="image.png"></p>
<ul>
<li>打开另一个客户端，给channel1发布消息hello <code>publish channel1 hello</code></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534693116-aaf579b2-52a1-4875-b10d-54bbf18f770e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=33&id=u59326715&margin=%5Bobject%20Object%5D&name=image.png&originHeight=33&originWidth=318&originalType=binary&ratio=1&rotation=0&showTitle=false&size=42163&status=done&style=none&taskId=u42f25462-4328-4bf8-b8ec-8b9a2775bb0&title=&width=318" alt="image.png"><br />返回的1是订阅者数量</p>
<ul>
<li>打开第一个客户端可以看到发送的消息</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648534715847-db018f58-a03e-4d16-bf3e-d67280dffb37.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=131&id=u3eff0373&margin=%5Bobject%20Object%5D&name=image.png&originHeight=131&originWidth=319&originalType=binary&ratio=1&rotation=0&showTitle=false&size=167641&status=done&style=none&taskId=u93bec09f-9ad3-46cc-95fa-76d6247d0d3&title=&width=319" alt="image.png"><br />注：发布的消息没有持久化，如果在订阅的客户端收不到hello，只能收到订阅后发布的消息<br><a name="tPtGW"></a></p>
<h1 id="新的数据类型"><a href="#新的数据类型" class="headerlink" title="新的数据类型"></a>新的数据类型</h1><p><a name="pizas"></a></p>
<h2 id="Bitmaps"><a href="#Bitmaps" class="headerlink" title="Bitmaps"></a>Bitmaps</h2><ol>
<li>简介</li>
</ol>
<p>本质上就是字符串，不过是在位上操作；大量用户访问可以减少内存占用</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>setbit<key><offset><value>设置Bitmaps中某个偏移量的值（0或1）*offset:偏移量从0开始</li>
<li>getbit<key><offset>获取Bitmaps中某个偏移量的值</li>
<li>bitcount<key>[start end] 统计字符串从start<strong>字节</strong>到end<strong>字节</strong>比特值为1的数量，统计<strong>字符串</strong>被设置为1的bit数</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648536090968-8df066a1-c171-4531-b823-431b4595a59a.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=303&id=u294dad02&margin=%5Bobject%20Object%5D&name=image.png&originHeight=303&originWidth=649&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26899&status=done&style=none&taskId=u35ea2621-78f3-40e8-9a33-cc26ef0c939&title=&width=649" alt="image.png"></li>
<li>bitop  and(or/not/xor) <destkey> [key…]  bitop是一个复合操作， 它可以做多个Bitmaps的and（交集） 、 or（并集） 、 not（非） 、 xor（异或） 操作并将结果保存在<strong>destkey</strong>中。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648536716794-e38f1ddf-675f-452f-b0b6-707c9d55965e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=84&id=ubf46cc7a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=84&originWidth=425&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5456&status=done&style=none&taskId=ufa77552f-4346-4c67-af5a-c22860523e1&title=&width=425" alt="image.png"><br><a name="jOquS"></a><h2 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a><strong>HyperLogLog</strong></h2></li>
</ul>
<ol>
<li>简介</li>
</ol>
<p>主要适用于解决基数问题（可以粗略理解为大量数据的去重，用很小的精度来解决大量的去重）</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>pfadd <key>&lt; element&gt; [element …]   添加指定元素到HyperLogLog 中</li>
<li>pfcount<key> [key …] 计算HLL的近似基数，可以计算多个HLL，比如用HLL存储每天的UV，计算一周的UV可以使用7天的UV合并计算即可</li>
<li>pfmerge<destkey><sourcekey> [sourcekey …]  将一个或多个HLL合并后的结果存储在另一个HLL中，比如每月活跃用户可以使用每天的活跃用户来合并计算可得</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648537539346-6ad924d4-2907-4fa9-aa83-55a2bd8a0ef1.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=175&id=uacdacb24&margin=%5Bobject%20Object%5D&name=image.png&originHeight=175&originWidth=501&originalType=binary&ratio=1&rotation=0&showTitle=false&size=10923&status=done&style=none&taskId=u8a5bbf9d-3d05-467b-bba1-b1960b8334f&title=&width=501" alt="image.png"><br><a name="js5lI"></a><h2 id="Geospatial"><a href="#Geospatial" class="headerlink" title="Geospatial"></a><strong>Geospatial</strong></h2></li>
</ul>
<ol>
<li>简介</li>
</ol>
<p>主要是对地理信息相关的操作</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>geoadd<key>&lt; longitude&gt;<latitude><member> [longitude latitude member…]   添加地理位置（经度，纬度，名称）</li>
<li>geopos  <key><member> [member…]  获得指定地区的坐标值</li>
<li>geodist<key><member1><member2>  [m|km|ft|mi ]  获取两个位置之间的直线距离</li>
<li>georadius<key>&lt; longitude&gt;<latitude>radius  m|km|ft|mi   以给定的经纬度为中心，找出某一半径内的元素</li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648538207831-abceda4f-1ec4-4d09-b401-bc9d5084f70e.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=261&id=uf546d35a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=261&originWidth=823&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25417&status=done&style=none&taskId=ue42b371d-4c16-45f6-82e9-812c87d4291&title=&width=823" alt="image.png"></li>
</ul>
<p><a name="Dr3SP"></a></p>
<h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><ol>
<li>简介</li>
</ol>
<p>主要用于Java中操作redis</p>
<ol start="2">
<li><p>使用准备</p>
<ol>
<li><p>导入依赖</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">3.2</span><span class="number">.0</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>linux系统中修改配置文件，关闭防火墙</p>
</li>
</ol>
</li>
</ol>
<p>systemctl status firewalld（查看防火墙状态）<br />**systemctl stop/disable firewalld.service   **<br />redis.conf中注释掉bind 127.0.0.1 ,然后protected-mode no</p>
<ol start="3">
<li><p>测试连接成功与否</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;192.168.241.128&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//成功则结果为 pong</span></span><br></pre></td></tr></table></figure></li>
<li><p>操作</p>
</li>
</ol>
<p>操作与命令方式一样，就相当于用<strong>jedis操作这个命令</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;192.168.241.128&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">    System.out.println(jedis.ping());</span><br><span class="line"></span><br><span class="line">    jedis.mset(<span class="string">&quot;k1&quot;</span>,<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;k2&quot;</span>,<span class="string">&quot;v2&quot;</span>,<span class="string">&quot;k3&quot;</span>,<span class="string">&quot;v3&quot;</span>); <span class="comment">//添加string</span></span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;k2&quot;</span>));</span><br><span class="line">    System.out.println(jedis.keys(<span class="string">&quot;*&quot;</span>));</span><br><span class="line">    System.out.println(jedis.exists(<span class="string">&quot;k1&quot;</span>));</span><br><span class="line">    System.out.println(jedis.ttl(<span class="string">&quot;k1&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;k1&quot;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>验证码实例</p>
<ol>
<li>实现思路<img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648541004127-05be695c-7ac0-4d1c-9e64-05d7e9321098.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=215&id=uc349d3d5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=358&originWidth=1122&originalType=binary&ratio=1&rotation=0&showTitle=false&size=217093&status=done&style=none&taskId=u43e32814-1d7b-4c7f-9702-43a9b291909&title=&width=674" alt="image.png"></li>
<li>代码如下<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">verifyCode</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//        System.out.println(getCode());</span></span><br><span class="line">        codeRedis(<span class="string">&quot;11212121234&quot;</span>,getCode());</span><br><span class="line"><span class="comment">//        getResult(&quot;11212121234&quot;,&quot;967191&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1 生成随机验证码</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCode</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Random random = <span class="keyword">new</span> Random();</span><br><span class="line">        String code=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">            code+=random.nextInt(<span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2 redis存入数据，并设置过期时间</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">codeRedis</span><span class="params">(String phone,String code)</span></span>&#123;</span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;192.168.241.128&quot;</span>,<span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">        String countKey=<span class="string">&quot;code&quot;</span>+phone+<span class="string">&quot;count:&quot;</span>;</span><br><span class="line">        String codeKey=<span class="string">&quot;code&quot;</span>+phone+<span class="string">&quot;:&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//判断次数，并存入redis</span></span><br><span class="line">        String count=jedis.get(countKey);</span><br><span class="line">        <span class="keyword">if</span>(count==<span class="keyword">null</span>)&#123;</span><br><span class="line">            jedis.setex(countKey,<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (Integer.parseInt(count)&lt;=<span class="number">2</span>)&#123;</span><br><span class="line">            jedis.incr(countKey);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;已达上限三次&quot;</span>);</span><br><span class="line">            jedis.close();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//将对应验证码加入redis</span></span><br><span class="line">        jedis.setex(codeKey,<span class="number">120</span>,code);</span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3 判断</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getResult</span><span class="params">(String phone,String code)</span></span>&#123;</span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;192.168.241.128&quot;</span>,<span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">        String codeKey=<span class="string">&quot;code&quot;</span>+phone+<span class="string">&quot;:&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(code.equals(jedis.get(codeKey)))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;failed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a name="euBi1"></a><h1 id="整合SpringBoot"><a href="#整合SpringBoot" class="headerlink" title="整合SpringBoot"></a>整合SpringBoot</h1></li>
</ol>
</li>
<li><p>导入依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- redis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- spring2.X集成redis所需common-pool2--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>编写配置文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Redis服务器地址</span></span><br><span class="line"><span class="meta">spring.redis.host</span>=<span class="string">192.168.241.128</span></span><br><span class="line"><span class="comment">#Redis服务器连接端口</span></span><br><span class="line"><span class="meta">spring.redis.port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment">#Redis数据库索引（默认为0）</span></span><br><span class="line"><span class="meta">spring.redis.database</span>= <span class="string">0</span></span><br><span class="line"><span class="comment">#连接超时时间（毫秒）</span></span><br><span class="line"><span class="meta">spring.redis.timeout</span>=<span class="string">1800000</span></span><br><span class="line"><span class="comment">#连接池最大连接数（使用负值表示没有限制）</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-active</span>=<span class="string">20</span></span><br><span class="line"><span class="comment">#最大阻塞等待时间(负数表示没限制)</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-wait</span>=<span class="string">-1</span></span><br><span class="line"><span class="comment">#连接池中的最大空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.max-idle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">#连接池中的最小空闲连接</span></span><br><span class="line"><span class="meta">spring.redis.lettuce.pool.min-idle</span>=<span class="string">0</span></span><br></pre></td></tr></table></figure></li>
<li><p>编写配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> <span class="keyword">extends</span> <span class="title">CachingConfigurerSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line"><span class="comment">//key序列化方式</span></span><br><span class="line">        template.setKeySerializer(redisSerializer);</span><br><span class="line"><span class="comment">//value序列化</span></span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line"><span class="comment">//value hashmap序列化</span></span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheManager <span class="title">cacheManager</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line"><span class="comment">//解决查询缓存转换异常的问题</span></span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line"><span class="comment">// 配置序列化（解决乱码的问题）,过期时间600秒</span></span><br><span class="line">        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()</span><br><span class="line">                .entryTtl(Duration.ofSeconds(<span class="number">600</span>))</span><br><span class="line">                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer))</span><br><span class="line">                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer))</span><br><span class="line">                .disableCachingNullValues();</span><br><span class="line">        RedisCacheManager cacheManager = RedisCacheManager.builder(factory)</span><br><span class="line">                .cacheDefaults(config)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>控制层编写</p>
</li>
</ol>
<p>主要对redis的操作使用<strong>RedisTemplate</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/redisTest&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testRedis</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//设置值到redis</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;lucy&quot;</span>);</span><br><span class="line">        <span class="comment">//从redis获取值</span></span><br><span class="line">        String name = (String)redisTemplate.opsForValue().get(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a name="JkkVe"></a></p>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><ol>
<li>简介</li>
</ol>
<p>Redis事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。<br />Redis事务的主要作用就是串联多个命令防止别的命令插队。</p>
<ol start="2">
<li>命令</li>
</ol>
<ul>
<li>multi 组队</li>
<li>exec执行</li>
<li>discard 中断组队        <img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648546629755-d91a5b55-f8a3-4d73-8b65-f448aa7a7b7d.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=260&id=udb274999&margin=%5Bobject%20Object%5D&name=image.png&originHeight=260&originWidth=691&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16409&status=done&style=none&taskId=ua455d4ee-4a52-4674-9a77-ec5bd7cde0d&title=&width=691" alt="image.png"></li>
<li><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648546989606-9ec192e9-e2ec-4cec-8bac-d41cb4226e6f.png#clientId=u6b2c068c-dfad-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=301&id=u8e991773&margin=%5Bobject%20Object%5D&name=image.png&originHeight=301&originWidth=552&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23403&status=done&style=none&taskId=ud540e6d0-7423-41f0-9fee-e5b15baf39d&title=&width=552" alt="image.png"></li>
</ul>
<ol start="3">
<li>疑问：为什么redis是单线程的还需要事务呢？</li>
</ol>
<p>对于redis服务器本身而言是没有竞态的，将活跃的客户端一个一个取出，将客户端中的请求一条一条执行，所有的处理都是one by one的。<br />但是，对于客户端而言是存在静态的，<strong>一个redis服务器会有多个客户端进行连接</strong>，他们之间可能会出现竞态的。</p>
<ol start="4">
<li>redis解决事务冲突的方法</li>
</ol>
<p>乐观锁。<strong>乐观锁(Optimistic Lock), <strong>顾名思义，就是很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。</strong>乐观锁适用于多读的应用类型，这样可以提高吞吐量</strong>。Redis就是利用这种check-and-set机制实现事务的。</p>
<ul>
<li>乐观锁执行命令：watch key1 [key2]</li>
</ul>
<p>在执行multi之前，先执行watch key1 [key2],可以监视一个(或多个) key ，如果在事务<strong>执行之前这个(或这些) key 被其他命令所改动，那么事务将被打断。</strong></p>
<ul>
<li>**unwatch **取消WATCH 命令对所有key 的监视。</li>
</ul>
<p>如果在执行WATCH 命令之后，EXEC 命令或DISCARD 命令先被执行了的话，那么就不需要再执行UNWATCH 了。</p>
<ol start="5">
<li>redis事务的特性</li>
</ol>
<ul>
<li>单独隔离操作<ul>
<li>事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。</li>
</ul>
</li>
<li>无隔离级别概念<ul>
<li>队列中的命令没有提交之前都不会实际被执行，因为事务提交前任何指令都不会被实际执行</li>
</ul>
</li>
<li>不保证原子性<ul>
<li>事务中如果有一条命令执行失败，其后的命令仍然会被执行，没有回滚 </li>
</ul>
</li>
</ul>
<ol start="6">
<li>事务–秒杀实例<ol>
<li>使用工具ab，来模拟秒杀请求的发送，多个请求以及并发</li>
</ol>
</li>
</ol>
<p>安装方式：yum install httpd-tools<br />使用命令：<code>ab -n 2000 -c 200 -k -p ~/postfile -T application/x-www-form-urlencoded http://192.168.2.115:8081/Seckill/doseckill</code>（模拟2000个用户，200个并发）<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648793686758-74a9dc77-ed8a-48c3-9d4f-b2a6ba186762.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=443&id=u972e4102&margin=%5Bobject%20Object%5D&name=image.png&originHeight=659&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=62499&status=done&style=none&taskId=u6a14dd72-4920-4a4b-ba62-cbb6c9f7a74&title=&width=576" alt="image.png"></p>
<ol start="2">
<li>出现连接超时的问题</li>
</ol>
<p>使用连接池来解决,节省每次连接redis服务带来的消耗，把连接好的实例反复利用。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisPoolUtil</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> JedisPool jedisPool = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">JedisPoolUtil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JedisPool <span class="title">getJedisPoolInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> == jedisPool) &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (JedisPoolUtil.class) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">null</span> == jedisPool) &#123;</span><br><span class="line">					JedisPoolConfig poolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">					poolConfig.setMaxTotal(<span class="number">200</span>);</span><br><span class="line">					poolConfig.setMaxIdle(<span class="number">32</span>);</span><br><span class="line">					poolConfig.setMaxWaitMillis(<span class="number">100</span>*<span class="number">1000</span>);</span><br><span class="line">					poolConfig.setBlockWhenExhausted(<span class="keyword">true</span>);</span><br><span class="line">					poolConfig.setTestOnBorrow(<span class="keyword">true</span>);  <span class="comment">// ping  PONG</span></span><br><span class="line">				 </span><br><span class="line">					jedisPool = <span class="keyword">new</span> JedisPool(poolConfig, <span class="string">&quot;192.168.44.168&quot;</span>, <span class="number">6379</span>, <span class="number">60000</span> );</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> jedisPool;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">(JedisPool jedisPool, Jedis jedis)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">null</span> != jedis) &#123;</span><br><span class="line">			jedisPool.returnResource(jedis);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>出现超卖问题，产品库存出现负数</li>
</ol>
<p>解决，使用乐观锁来解决</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//秒杀过程</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">doSecKill</span><span class="params">(String uid,String prodid)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//1 uid和prodid非空判断</span></span><br><span class="line">    <span class="keyword">if</span>(uid == <span class="keyword">null</span> || prodid == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2 连接redis</span></span><br><span class="line">    <span class="comment">//Jedis jedis = new Jedis(&quot;192.168.44.168&quot;,6379);</span></span><br><span class="line">    <span class="comment">//通过连接池得到jedis对象</span></span><br><span class="line">    JedisPool jedisPoolInstance = JedisPoolUtil.getJedisPoolInstance();</span><br><span class="line">    Jedis jedis = jedisPoolInstance.getResource();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3 拼接key</span></span><br><span class="line">    <span class="comment">// 3.1 库存key</span></span><br><span class="line">    String kcKey = <span class="string">&quot;sk:&quot;</span>+prodid+<span class="string">&quot;:qt&quot;</span>;</span><br><span class="line">    <span class="comment">// 3.2 秒杀成功用户key</span></span><br><span class="line">    String userKey = <span class="string">&quot;sk:&quot;</span>+prodid+<span class="string">&quot;:user&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//监视库存</span></span><br><span class="line">    jedis.watch(kcKey);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4 获取库存，如果库存null，秒杀还没有开始</span></span><br><span class="line">    String kc = jedis.get(kcKey);</span><br><span class="line">    <span class="keyword">if</span>(kc == <span class="keyword">null</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;秒杀还没有开始，请等待&quot;</span>);</span><br><span class="line">        jedis.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5 判断用户是否重复秒杀操作</span></span><br><span class="line">    <span class="keyword">if</span>(jedis.sismember(userKey, uid)) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;已经秒杀成功了，不能重复秒杀&quot;</span>);</span><br><span class="line">        jedis.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6 判断如果商品数量，库存数量小于1，秒杀结束</span></span><br><span class="line">    <span class="keyword">if</span>(Integer.parseInt(kc)&lt;=<span class="number">0</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;秒杀已经结束了&quot;</span>);</span><br><span class="line">        jedis.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//7 秒杀过程</span></span><br><span class="line">    <span class="comment">//使用事务</span></span><br><span class="line">    Transaction multi = jedis.multi();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//组队操作</span></span><br><span class="line">    multi.decr(kcKey);</span><br><span class="line">    multi.sadd(userKey,uid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//执行</span></span><br><span class="line">    List&lt;Object&gt; results = multi.exec();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(results == <span class="keyword">null</span> || results.size()==<span class="number">0</span>) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;秒杀失败了....&quot;</span>);</span><br><span class="line">        jedis.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//7.1 库存-1</span></span><br><span class="line">    <span class="comment">//jedis.decr(kcKey);</span></span><br><span class="line">    <span class="comment">//7.2 把秒杀成功用户添加清单里面</span></span><br><span class="line">    <span class="comment">//jedis.sadd(userKey,uid);</span></span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;秒杀成功了..&quot;</span>);</span><br><span class="line">    jedis.close();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>库存遗留问题</li>
</ol>
<p>指抢购结束，有人没抢到商品，库存却还有。原因：乐观锁导致很多请求失败了，先点的失败，后点却成功了。通过LUA脚本来解决这个问题：<br />将复杂的或者多步的redis操作，写为一个脚本，一次提交给redis执行，减少反复连接redis的次数。提升性能。LUA脚本是类似redis事务，<strong>有一定的原子性，不会被其他命令插队</strong>，可以完成一些redis事务性的操作。但是注意redis的lua脚本功能，只有在Redis 2.6以上的版本才可以使用。<br />利用lua脚本淘汰用户，解决超卖问题。<br />redis 2.6版本以后，<strong>通过lua脚本解决争抢问题，实际上是redis 利用其单线程的特性，用任务队列的方式解决多任务并发问题。</strong><br><a name="Onriq"></a></p>
<h1 id="redis持久化"><a href="#redis持久化" class="headerlink" title="redis持久化"></a>redis持久化</h1><p>redis信息存在内存之中，持久化就是将其存到硬盘之中<br><a name="GSwuU"></a></p>
<h2 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h2><ol>
<li>简介</li>
</ol>
<p>redis database，在指定的时间间隔内将内存中的数据集快照写入磁盘，也就是行话讲的Snapshot快照，它恢复时是将快照文件直接读到内存里。<strong>redis默认开启</strong></p>
<ol start="2">
<li>执行过程</li>
</ol>
<p>Redis会单独创建（fork）一个子进程来进行持久化，会先将数据写入到一个临时文件中，待持久化过程都结束了，再用这个临时文件替换上次持久化好的文件。整个过程中，主进程是不进行任何IO操作的，这就确保了极高的性能 如果需要进行大规模数据的恢复，且对于数据恢复的完整性不是非常敏感，那RDB方式要比AOF方式更加的高效。<strong>RDB的缺点是最后一次持久化后的数据可能丢失</strong>。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648803770803-6b644b92-5901-452f-9e04-d79f34285aa8.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=196&id=u0e3445ab&margin=%5Bobject%20Object%5D&name=image.png&originHeight=196&originWidth=533&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32136&status=done&style=none&taskId=u22c96676-9f5a-4587-97a1-a19d242df54&title=&width=533" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648803787926-607872d4-604d-4c97-97d3-7a447cf31faf.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=257&id=ubcb01135&margin=%5Bobject%20Object%5D&name=image.png&originHeight=257&originWidth=369&originalType=binary&ratio=1&rotation=0&showTitle=false&size=380285&status=done&style=none&taskId=u23aafdde-2e05-4458-aa1c-aebe602796c&title=&width=369" alt="image.png"><br />为什么要用临时文件，而不是直接持久化到硬盘之中呢？<br />防止持久化的数据缺失，不完整；比如，我数据复制到一半的时候，服务器挂了，那硬盘之中的数据就是异常的，显然不行。复制到临时文件中就不用考虑，因为是否备份的权力还是在我自己。</p>
<ol start="3">
<li>配置文件中相关的信息</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804027310-9c92d91e-ac83-4419-9231-7feaafeb43c1.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=98&id=uda0af975&margin=%5Bobject%20Object%5D&name=image.png&originHeight=98&originWidth=464&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7209&status=done&style=none&taskId=u95e5de3e-a074-44cf-aa6b-29233f09578&title=&width=464" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804129394-95f64cdf-ae2a-4b2e-bb8d-31859916f88c.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=60&id=u133be509&margin=%5Bobject%20Object%5D&name=image.png&originHeight=60&originWidth=497&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5873&status=done&style=none&taskId=ubde03a96-fbad-461b-96df-023984ca17f&title=&width=497" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648804247337-11d14558-ce0d-48be-8f3b-45827744a55a.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=83&id=u89da5b15&margin=%5Bobject%20Object%5D&name=image.png&originHeight=83&originWidth=396&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7885&status=done&style=none&taskId=ue7f03418-c70a-48a3-87be-a75b55b1065&title=&width=396" alt="image.png"></p>
<ol start="4">
<li>测试备份使用方法</li>
</ol>
<p>先关闭redis，复制dump.rdb到其他地方，即使删除原来的dump.rdb，将复制的文件复制回来，redis依然可以在重启的时候加载出数据。<br />停止保存策略：<code>redis-cli config set save &quot;&quot;</code>#save后给空值，表示禁用保存策略</p>
<p><a name="PzuHZ"></a></p>
<h2 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h2><ol>
<li>简介</li>
</ol>
<p>append only file，以<strong>日志</strong>的形式来记录每个写操作（增量保存），将Redis执行过的所有写指令记录下来(<strong>读操作不记录</strong>)， <strong>只许追加文件但不可以改写文件</strong>，redis启动之初会读取该文件重新构建数据，换言之，redis 重启的话就根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作。<strong>redis默认关闭</strong></p>
<ol start="2">
<li>执行流程<ol>
<li>客户端的请求写命令会被append追加到AOF缓冲区内；</li>
<li>AOF缓冲区根据AOF持久化策略[always,everysec,no]将操作sync同步到磁盘的AOF文件中；</li>
<li>AOF文件大小超过重写策略或手动重写时，会对AOF文件rewrite重写，压缩AOF文件容量；<ul>
<li>压缩是指将某些产生相同结果的命令缩减，比如多个set，压缩成mset。可以使用命令bgrewriteaof</li>
<li>AOF文件持续增长而过大时，会fork出一条新进程来将文件重写(也是先写临时文件最后再rename)，redis4.0版本后的重写，是指上就是把rdb 的快照，以二级制的形式附在新的aof头部，作为已有的历史数据，替换掉原来的流水账操作。</li>
<li>触发时刻：Redis会记录上次重写时的AOF大小，默认配置是当AOF文件大小是上次rewrite后大小的一倍且文件大于64M时触发</li>
<li>重写虽然可以节约大量磁盘空间，减少恢复时间。但是每次重写还是有一定的负担的，因此设定Redis要满足一定条件才会进行重写。 </li>
</ul>
</li>
<li>Redis服务重启时，会重新load加载AOF文件中的写操作达到数据恢复的目的；</li>
</ol>
</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806164831-f5aad4cc-46cc-4940-83e5-d304b0afa18e.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=383&id=u2d46b0c5&margin=%5Bobject%20Object%5D&name=image.png&originHeight=383&originWidth=234&originalType=binary&ratio=1&rotation=0&showTitle=false&size=359526&status=done&style=none&taskId=u4a2f1a76-e4d8-4ced-9fc2-7251a8c99c5&title=&width=234" alt="image.png"></p>
<ol start="3">
<li>配置信息相关</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806294535-f1237e00-9ada-43d0-8a4c-2e283e0ec09b.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=107&id=uf7aa95fb&margin=%5Bobject%20Object%5D&name=image.png&originHeight=107&originWidth=578&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7669&status=done&style=none&taskId=u8d2a29b6-f466-414a-8244-bf61c16a34c&title=&width=578" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806393052-c259106c-1c01-432f-84b3-f64660de2a0e.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=75&id=u5c50bfc3&margin=%5Bobject%20Object%5D&name=image.png&originHeight=75&originWidth=422&originalType=binary&ratio=1&rotation=0&showTitle=false&size=4304&status=done&style=none&taskId=u87f96674-eeab-4b3e-b4fc-6c17c75f23d&title=&width=422" alt="image.png"><br />appendfsync always<br />始终同步，每次Redis的写入都会立刻记入日志；性能较差但数据完整性比较好<br />appendfsync everysec<br />每秒同步，每秒记入日志一次，如果宕机，本秒的数据可能丢失。<br />appendfsync no<br />redis不主动进行同步，把同步时机交给操作系统。</p>
<ol start="4">
<li>备份使用方式</li>
</ol>
<p>同rdb；<br />异常恢复使用：<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648806502161-cb24d4fa-aea5-42e7-a490-791bde455469.png#clientId=uae540855-5520-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=158&id=ufa61942e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=158&originWidth=416&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9689&status=done&style=none&taskId=ua89e16c9-832d-4cd7-adae-b56fcfa671e&title=&width=416" alt="image.png"><br><a name="k06e1"></a></p>
<h2 id="优劣对比"><a href="#优劣对比" class="headerlink" title="优劣对比"></a>优劣对比</h2><ol>
<li>优先级？</li>
</ol>
<p>rdb默认开启，aof默认关闭；官方推荐都开启，优先aof，因为能保证数据的完整性</p>
<ol start="2">
<li><p>rdb</p>
<ul>
<li><p>适合大规模的数据恢复</p>
</li>
<li><p>对数据完整性和一致性要求不高更适合使用</p>
</li>
<li><p>节省磁盘空间</p>
</li>
<li><p>恢复速度快</p>
</li>
<li><p>Fork的时候，内存中的数据被克隆了一份，大致2倍的膨胀性需要考虑</p>
</li>
<li><p>虽然Redis在fork时使用了写时拷贝技术,但是如果数据庞大时还是比较消耗性能。</p>
</li>
<li><p>在备份周期在一定间隔时间做一次备份，所以如果Redis意外down掉的话，就会丢失最后一次快照后的所有修改。</p>
</li>
</ul>
</li>
<li><p>aof</p>
<ul>
<li><p>备份机制更稳健，丢失数据概率更低。</p>
</li>
<li><p>可读的日志文本，通过操作AOF稳健，可以处理误操作</p>
</li>
<li><p>比起RDB占用更多的磁盘空间。</p>
</li>
<li><p>恢复备份速度要慢。</p>
</li>
<li><p>每次读写都同步的话，有一定的性能压力。</p>
</li>
<li><p>存在个别Bug，造成恢复不能。</p>
</li>
</ul>
</li>
</ol>
<p><a name="glPhg"></a></p>
<h1 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h1><ol>
<li>简介</li>
</ol>
<p>主机数据更新后根据配置和策略， 自动同步到备机的master/slaver机制，Master以写为主，Slave以读为主</p>
<ul>
<li>读写分离，性能扩展</li>
<li>容灾快速恢复</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648807938667-2126e748-74f8-4560-bfd8-1556beb9d9af.png#clientId=ubb72c0e7-b548-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=206&id=u45e0ce81&margin=%5Bobject%20Object%5D&name=image.png&originHeight=206&originWidth=324&originalType=binary&ratio=1&rotation=0&showTitle=false&size=267690&status=done&style=none&taskId=u95e439a2-d074-4d89-9e61-3d65af6f554&title=&width=324" alt="image.png"><br />一般是一主多从，多个主可以通过集群来解决</p>
<ol start="2">
<li>简单的实现（一主两从）</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648864790771-5193cde2-eae9-40f1-9185-caa2099b45e2.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=214&id=u0b197d2d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=214&originWidth=589&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25682&status=done&style=none&taskId=uab6f67f1-7d02-4a49-88cd-ca897e2dcfe&title=&width=589" alt="image.png"><br />配置文件信息如下：<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648864847245-9f1a56be-0318-41b8-b8fa-1153c4da7e2a.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=83&id=uc3b906d6&margin=%5Bobject%20Object%5D&name=image.png&originHeight=83&originWidth=274&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3266&status=done&style=none&taskId=uc3d9ade6-b65e-4fa8-8ce9-11bd1c16a5d&title=&width=274" alt="image.png"><br />启动<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865226020-01c0d6cb-819f-4c57-9d28-b1fa4bf00f34.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=162&id=u47552c63&margin=%5Bobject%20Object%5D&name=image.png&originHeight=162&originWidth=675&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16893&status=done&style=none&taskId=ua54e272b-b67f-4478-aa98-6968a9a4c2a&title=&width=675" alt="image.png"><br />进入客户端之后，查看主从复制相关信息<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865630642-c901109d-6a8a-4728-9efa-36df64b9ed12.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=219&id=u5d4935dc&margin=%5Bobject%20Object%5D&name=image.png&originHeight=219&originWidth=537&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13090&status=done&style=none&taskId=u39bff67a-62d4-44d5-b757-c1aad324315&title=&width=537" alt="image.png"><br />可以发现，此时全部都是主机，设置从机的命令：<code>slaveof  &lt;ip&gt;&lt;port&gt;</code><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865834172-4647a5b8-e0e5-4805-96bf-04d3130d1083.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=258&id=u6109724a&margin=%5Bobject%20Object%5D&name=image.png&originHeight=258&originWidth=465&originalType=binary&ratio=1&rotation=0&showTitle=false&size=13643&status=done&style=none&taskId=u4027846e-e084-41ef-905e-4e10dc0a83c&title=&width=465" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648865892851-e451bd8f-eb14-4585-914b-be1199fc22f5.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=396&id=u7d49ebb0&margin=%5Bobject%20Object%5D&name=image.png&originHeight=396&originWidth=538&originalType=binary&ratio=1&rotation=0&showTitle=false&size=19826&status=done&style=none&taskId=u6f47634c-cded-4ab5-8f3b-61a9904f8de&title=&width=538" alt="image.png"><br />简单查询数据，可以发现从机已经可以获取到主机新增的数据了（<strong>主机连接之前的获取不到</strong>），且从机无法进行写操作，只有读操作。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648866131948-ff3accd3-ecf2-4d0b-adb3-b9454f6590e9.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=82&id=ufbdea284&margin=%5Bobject%20Object%5D&name=image.png&originHeight=82&originWidth=494&originalType=binary&ratio=1&rotation=0&showTitle=false&size=5469&status=done&style=none&taskId=u28aff42e-6dbb-4e97-8c21-aadde9132be&title=&width=494" alt="image.png"><br />主从复制支持套娃，<strong>从机也可以当其他从机的主机（当然还是不能写，小弟就是小弟）</strong><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648867860710-fcec0c88-bf90-49b3-8e1a-f70c8de36e9f.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=416&id=u4e112fb8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=416&originWidth=658&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29717&status=done&style=none&taskId=u2d120bab-a6d3-4e6f-bcde-9f134b0e825&title=&width=658" alt="image.png"></p>
<ol start="3">
<li>从机挂掉分析<ul>
<li>挂掉之后再重启，默认是一个新的主机</li>
<li>重新连接主机之后，<strong>会把自己错过的重新复制一遍数据（之前连接时候的数据还在，因为持久化）</strong>，比如主机1，2，3；复制就是3，2，1（<strong>主机连接之前的获取不到</strong>）</li>
</ul>
</li>
<li>主机挂掉分析<ul>
<li>挂掉再连接还是之前的主机</li>
<li>从机在主机挂掉期间，不会自动变成主机，还是从机，相关信息可以看到主机挂了</li>
</ul>
</li>
<li>复制原理</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648867011462-629f12e7-a5d5-4d10-96af-67e310e9ff42.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=274&id=uac553ea3&margin=%5Bobject%20Object%5D&name=03-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86.png&originHeight=620&originWidth=1376&originalType=binary&ratio=1&rotation=0&showTitle=false&size=16292&status=done&style=none&taskId=ua7745bdd-b2b7-477e-8a28-3f9744e429a&title=&width=609" alt="03-主从复制原理.png"></p>
<ol start="6">
<li>哨兵模式<ol>
<li>反客为主</li>
</ol>
</li>
</ol>
<p>当主机挂掉，可以使用命令<code>slaveof no one</code>来将从机升级成为主机，每次都要手动执行，不方便</p>
<ol start="2">
<li>哨兵模式（上述升级版）<ol>
<li>实现</li>
</ol>
</li>
</ol>
<p>设置好一主两从，新增文件sentinel.conf<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648869827721-8a549aa3-9be1-48ba-8293-a5bd12051eed.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=47&id=u22d2826d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=47&originWidth=351&originalType=binary&ratio=1&rotation=0&showTitle=false&size=2374&status=done&style=none&taskId=ue10552c8-497c-4cc3-b073-87518ec8019&title=&width=351" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870373239-e5e3b86d-f67e-411d-9c62-f4750068179c.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=392&id=uf8194831&margin=%5Bobject%20Object%5D&name=image.png&originHeight=493&originWidth=744&originalType=binary&ratio=1&rotation=0&showTitle=false&size=39532&status=done&style=none&taskId=u034aef6d-be76-4726-bf83-57dc9f0a7c8&title=&width=591" alt="image.png"><br />将主机挂掉之后，6380自动升级成为主机<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870440257-24a102d3-7ae4-48e6-bde0-ee1afed59c1b.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=110&id=u495eae2d&margin=%5Bobject%20Object%5D&name=image.png&originHeight=152&originWidth=831&originalType=binary&ratio=1&rotation=0&showTitle=false&size=21748&status=done&style=none&taskId=uddc6606b-22b9-4ebb-98b1-68913267e8b&title=&width=601" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870561523-ca2cb646-d128-4044-b0ce-62dd107dc1c2.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=99&id=u5ed9eb70&margin=%5Bobject%20Object%5D&name=image.png&originHeight=99&originWidth=396&originalType=binary&ratio=1&rotation=0&showTitle=false&size=7206&status=done&style=none&taskId=u0d50d801-28d8-4e55-b062-54cc322f9f4&title=&width=396" alt="image.png"></p>
<pre><code>  2. 分析
</code></pre>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648870600742-738209a7-f940-41a0-9d8e-a79580832251.png#clientId=uda81e349-2c44-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=301&id=ue6642fe4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=301&originWidth=553&originalType=binary&ratio=1&rotation=0&showTitle=false&size=667274&status=done&style=none&taskId=u2d27035b-1a8f-4929-8c1e-13f622f3eca&title=&width=553" alt="image.png"><br />偏移量大小指获得主机数据全面，越全面越大<br />runid，每个redis实例都会生成40位</p>
<pre><code>  3. 问题
</code></pre>
<p>由于所有的写操作都是先在Master上操作，然后同步更新到Slave上，所以从Master同步到Slave机器有一定的延迟，当系统很繁忙的时候，延迟问题会更加严重，Slave机器数量的增加也会使这个问题更加严重。</p>
<ol start="3">
<li><p>jedis代码实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> JedisSentinelPool jedisSentinelPool=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  Jedis <span class="title">getJedisFromSentinel</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(jedisSentinelPool==<span class="keyword">null</span>)&#123;</span><br><span class="line">        Set&lt;String&gt; sentinelSet=<span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">        sentinelSet.add(<span class="string">&quot;192.168.11.103:26379&quot;</span>);</span><br><span class="line"></span><br><span class="line">        JedisPoolConfig jedisPoolConfig =<span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        jedisPoolConfig.setMaxTotal(<span class="number">10</span>); <span class="comment">//最大可用连接数</span></span><br><span class="line">        jedisPoolConfig.setMaxIdle(<span class="number">5</span>); <span class="comment">//最大闲置连接数</span></span><br><span class="line">        jedisPoolConfig.setMinIdle(<span class="number">5</span>); <span class="comment">//最小闲置连接数</span></span><br><span class="line">        jedisPoolConfig.setBlockWhenExhausted(<span class="keyword">true</span>); <span class="comment">//连接耗尽是否等待</span></span><br><span class="line">        jedisPoolConfig.setMaxWaitMillis(<span class="number">2000</span>); <span class="comment">//等待时间</span></span><br><span class="line">        jedisPoolConfig.setTestOnBorrow(<span class="keyword">true</span>); <span class="comment">//取连接的时候进行一下测试 ping pong</span></span><br><span class="line"></span><br><span class="line">        jedisSentinelPool=<span class="keyword">new</span> JedisSentinelPool(<span class="string">&quot;mymaster&quot;</span>,sentinelSet,jedisPoolConfig);</span><br><span class="line">        <span class="keyword">return</span> jedisSentinelPool.getResource();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> jedisSentinelPool.getResource();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a name="GUdDM"></a></p>
<h1 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h1></li>
<li><p>简介</p>
</li>
</ol>
<p>Redis 集群实现了对Redis的水平扩容，即启动N个redis节点，将整个数据库分布存储在这N个节点中，<strong>每个节点存储总数据的1/N</strong>。<strong>无论哪个主机写数据，其他主机都能读到数据。</strong><br />Redis 集群通过分区（partition）来提供一定程度的可用性（availability）：即使集群中有一部分节点失效或者无法进行通讯，集群也可以继续处理命令请求。实现redis的<strong>容量水平扩容</strong>，和<strong>并发写操作的分摊</strong></p>
<ol start="2">
<li>简单实现</li>
</ol>
<p>首先删除之前生成的rdb,aof文件，重新写六个配置文件（:%s/6379/6380快速替换）<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648881347666-50c01f5d-7320-4e88-b1e1-6416ef886b93.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=122&id=ua2da2993&margin=%5Bobject%20Object%5D&name=image.png&originHeight=122&originWidth=469&originalType=binary&ratio=1&rotation=0&showTitle=false&size=9955&status=done&style=none&taskId=ub80c11bd-4456-4b49-9187-eb50cedf0af&title=&width=469" alt="image.png"><br />将六个redis实例启动，到redis.6.2.6/src目录下然后合体<br /><code>redis-cli --cluster create --cluster-replicas 1 192.168.11.101:6379 192.168.11.101:6380 192.168.11.101:6381 192.168.11.101:6389 192.168.11.101:6390 192.168.11.101:6391</code>一个集群至少要有三个主节点。选项 –cluster-replicas 1 表示我们希望为集群中的每个主节点创建一个从节点。分配原则尽量保证每个主数据库运行在不同的IP地址，每个从库和主库不在一个IP地址上。<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648882425234-c00473d6-c3b2-4037-b323-0ae4dbc4e07c.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=609&id=u14d269c2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=833&originWidth=856&originalType=binary&ratio=1&rotation=0&showTitle=false&size=94542&status=done&style=none&taskId=uaed59558-5cc9-4b19-a071-79f50050c2d&title=&width=626" alt="image.png"><br />查看集群相关信息<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648883985300-e0c6238c-a442-439b-bbf8-b1f79450993d.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=161&id=uc986db01&margin=%5Bobject%20Object%5D&name=image.png&originHeight=195&originWidth=841&originalType=binary&ratio=1&rotation=0&showTitle=false&size=26301&status=done&style=none&taskId=u46307eb6-81e5-4e34-9364-286a1334962&title=&width=693" alt="image.png"><br />插槽的概念slots，一共16384，每个节点平均分，插入的值会自动转到对应节点下<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648884358614-be6e4902-bec8-4a61-9154-c37011a947db.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=155&id=ua306757e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=192&originWidth=833&originalType=binary&ratio=1&rotation=0&showTitle=false&size=25162&status=done&style=none&taskId=ub1f1cced-1c7c-4a04-aa2b-0284d5736d7&title=&width=673" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648885122084-1b58ef27-cd6f-44c0-a774-9725f06c7f2c.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=190&id=uc8a087c2&margin=%5Bobject%20Object%5D&name=image.png&originHeight=200&originWidth=714&originalType=binary&ratio=1&rotation=0&showTitle=false&size=29121&status=done&style=none&taskId=u62798e80-753d-47bc-9472-2d6ff90476e&title=&width=680" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648889837952-f37ea733-8c31-43e0-aab4-e5b845830fd7.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=47&id=u340bd26b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=47&originWidth=450&originalType=binary&ratio=1&rotation=0&showTitle=false&size=3066&status=done&style=none&taskId=uc6ed2201-a3c8-482e-9ee6-97ddfd2613d&title=&width=450" alt="image.png"><br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648889875481-b38a1d94-1ca0-4f57-a309-f6e80745b95f.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=417&id=u7ee5abd8&margin=%5Bobject%20Object%5D&name=image.png&originHeight=590&originWidth=910&originalType=binary&ratio=1&rotation=0&showTitle=false&size=28974&status=done&style=none&taskId=u0b238606-276b-42dd-94b3-c6a1eb3e475&title=&width=643" alt="image.png"></p>
<ol start="3">
<li>异常处理</li>
</ol>
<ul>
<li>主节点挂掉，从节点自动升级成为主节点</li>
<li>原来的主节点恢复也只是从节点</li>
<li>要是一段插槽的主从节点全部挂掉，怎么处理？<ul>
<li>取决与redis.conf中的<strong>cluster-require-full-coverage</strong></li>
<li>若为yes则整个都挂掉，反之为no只有该段插槽全都无法使用<br><a name="xaaEa"></a><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><a name="cR1u6"></a><h2 id="缓存穿透"><a href="#缓存穿透" class="headerlink" title="缓存穿透"></a>缓存穿透</h2></li>
</ul>
</li>
</ul>
<ol>
<li>问题描述</li>
</ol>
<p>一直请求不存在的数据，导致缓存几乎失效，一直向缓存和数据库中查询不存在的数据，返回空的数据，redis又不会存储空结果，服务器压力过大<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648892822303-1ce42d79-cc84-4b6e-bd89-fe47155a73c2.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9665&crop=0.76&from=paste&height=684&id=uacf2ffcc&margin=%5Bobject%20Object%5D&name=05-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=160487&status=done&style=none&taskId=u68bc1b0c-ea54-46dd-b44b-a847e7b2435&title=&width=1332" alt="05-缓存穿透.png"></p>
<ol start="2">
<li>解决措施</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893220437-6176781f-ce6a-4d27-8331-1a2067679453.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=402&id=u042b964e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=402&originWidth=507&originalType=binary&ratio=1&rotation=0&showTitle=false&size=44641&status=done&style=none&taskId=u0a04b37d-a502-43af-ac8b-d02f15f79dd&title=&width=507" alt="image.png"><br><a name="ZyAxM"></a></p>
<h2 id="缓存击穿"><a href="#缓存击穿" class="headerlink" title="缓存击穿"></a>缓存击穿</h2><ol>
<li>问题描述</li>
</ol>
<p>redis正常运行，但刚好一个key过期的时候，大量使用这个key的请求涌入，可能压垮服务器<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893598495-090f292e-69ba-4806-91fd-52586992d67d.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9651&crop=0.6947&from=paste&height=683&id=ua13034fb&margin=%5Bobject%20Object%5D&name=06-%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=120604&status=done&style=none&taskId=ua71b13f7-b9c1-43d4-ba3e-69554e7e44f&title=&width=1330" alt="06-缓存击穿.png"></p>
<ol start="2">
<li>解决方式</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893676537-013ce44b-4380-4a8f-9795-5a5b0e45fb32.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=707&id=u55c7c011&margin=%5Bobject%20Object%5D&name=image.png&originHeight=707&originWidth=605&originalType=binary&ratio=1&rotation=0&showTitle=false&size=75907&status=done&style=none&taskId=u868e97ac-6f4a-49d8-a785-d4cb83d90de&title=&width=605" alt="image.png"><br><a name="hyx8i"></a></p>
<h2 id="缓存雪崩"><a href="#缓存雪崩" class="headerlink" title="缓存雪崩"></a>缓存雪崩</h2><ol>
<li>问题描述</li>
</ol>
<p>某个极端时间内，大量key过期，造成服务器压力瞬间过大<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648893937035-1bd8a984-bc88-4492-a2c2-50a6533c0cf5.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=0.9397&crop=0.7548&from=paste&height=665&id=ufa498b1c&margin=%5Bobject%20Object%5D&name=07-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=141331&status=done&style=none&taskId=u647c8675-2938-4b38-84d6-0ee8f944afd&title=&width=1295" alt="07-缓存雪崩.png"></p>
<ol start="2">
<li>解决方案</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1648894033964-28b6eaf3-de5b-4733-a6d1-b31b86ad5dd3.png#clientId=ud5d8fd42-4601-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=336&id=udb77d739&margin=%5Bobject%20Object%5D&name=image.png&originHeight=336&originWidth=505&originalType=binary&ratio=1&rotation=0&showTitle=false&size=32200&status=done&style=none&taskId=u1e8764df-5124-4a8a-ba46-2d7ec44187a&title=&width=505" alt="image.png"></p>
<p><a name="PVhan"></a></p>
<h2 id="分布式锁"><a href="#分布式锁" class="headerlink" title="分布式锁"></a>分布式锁</h2><ol>
<li>简介</li>
</ol>
<p>分布式系统多线程，多进程分布在不同不同机器上，单纯的Java api无法提供分布式锁。可使用redis来实现</p>
<ol start="2">
<li>简单使用</li>
</ol>
<p><code>set user 11 nx ex 10</code>(原子操作，防止执行一个命令执行就挂掉的极端情况）<br />nx上锁，ex设置过期时间</p>
<ol start="3">
<li>可能出现的问题—&gt;误删锁？</li>
</ol>
<p><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1649234227386-5101822b-2579-485a-8aa9-8853d795db6c.png#clientId=u5b6aea5e-c01f-4&crop=0.0383&crop=0.0507&crop=0.9463&crop=0.8657&from=paste&height=304&id=u1cf2839a&margin=%5Bobject%20Object%5D&name=09-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88UUID%E9%98%B2%E8%AF%AF%E5%88%A0%EF%BC%89.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=23787&status=done&style=none&taskId=u068be09a-20eb-40c9-9108-43229861f28&title=&width=592" alt="09-分布式锁（UUID防误删）.png"><br />大概描述就是a由于卡顿或者其他因素锁自动释放了，b拿到锁之后，此时a认为该释放锁了，将b的锁又手动释放了。<br />解决：添加一个uuid，只有执行释放锁操作的uuid和获取该锁的uuid一样时才执行该操作</p>
<p>上述操作存在一个问题，就是可能a卡了一下自动释放了，然后刚好判断uuid一样a把b刚拿到的锁释放了，原因是因为缺乏原子性；使用lua脚本可解决<br /><img src="https://cdn.nlark.com/yuque/0/2022/png/22078302/1649234773183-aa5734eb-e8eb-40b4-99b1-7442f3852f9f.png#clientId=u5b6aea5e-c01f-4&crop=0&crop=0&crop=0.7413&crop=0.8669&from=paste&height=525&id=u605a56a3&margin=%5Bobject%20Object%5D&name=10-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%EF%BC%88%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%EF%BC%89.png&originHeight=708&originWidth=1378&originalType=binary&ratio=1&rotation=0&showTitle=false&size=17460&status=done&style=none&taskId=ub5c44e66-d385-4f8f-9927-fc6d9f9842b&title=&width=1021" alt="10-分布式锁（原子操作）.png"><br><a name="dtMSl"></a></p>
<h1 id="新功能"><a href="#新功能" class="headerlink" title="新功能"></a>新功能</h1><ol>
<li>ACL</li>
</ol>
<ul>
<li>就是对操作权限进行更细化的控制</li>
<li>acl list查看用户权限列表</li>
<li>acl cat命令查看添加权限指令类别（加参数类型名可以查看类型下具体命令）</li>
<li>acl whoami命令查看当前用户</li>
<li>aclsetuser命令创建和编辑用户ACL</li>
</ul>
<ol start="2">
<li>多线程</li>
</ol>
<ul>
<li>并不是单线程变成多线程的意思</li>
<li>IO多线程其实指<strong>客户端交互部分</strong>的<strong>网络IO</strong>交互处理模块<strong>多线程</strong>，而非<strong>执行命令多线程</strong></li>
</ul>
<ol start="3">
<li>工具支持cluster</li>
</ol>
<ul>
<li>无需再安装ruby环境</li>
</ul>
<ol start="4">
<li>RESP3新的 Redis 通信协议：优化服务端与客户端之间通信</li>
<li>Client side caching客户端缓存：基于RESP3 协议实现的客户端缓存功能。为了进一步提升缓存的性能，将客户端经常访问的数据cache到客户端。减少TCP网络交互。</li>
<li>Proxy集群代理模式：Proxy 功能，让 Cluster 拥有像单实例一样的接入方式，降低大家使用cluster的门槛。不过需要注意的是代理不改变 Cluster 的功能限制，不支持的命令还是不会支持，比如跨 slot 的多Key操作。</li>
<li>Modules API</li>
</ol>
<p>Redis 6中模块API开发进展非常大，因为Redis Labs为了开发复杂的功能，从一开始就用上Redis模块。Redis可以变成一个框架，利用Modules来构建不同系统，而不需要从头开始写然后还要BSD许可。Redis一开始就是一个向编写各种系统开放的平台。</p>
<p><a name="gx8rt"></a></p>
<h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><p>感谢尚硅谷的视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Rv41177Af">https://www.bilibili.com/video/BV1Rv41177Af</a></p>

    </div>

    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>


    
    
    
        <div class="reward-container">
  <div>您的支持将成为我创作的动力！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="Jie 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Jie 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Jie
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://example.com/article/8eda3648.html" title="Redis学习笔记">http://example.com/article/8eda3648.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/springboot/" rel="tag"># springboot</a>
              <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/article/a25851fc.html" rel="prev" title="springboot学习笔记2">
      <i class="fa fa-chevron-left"></i> springboot学习笔记2
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#NoSQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">2.</span> <span class="nav-text">NoSQL数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">2.1.</span> <span class="nav-text">简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">2.1.1.</span> <span class="nav-text">适用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">2.1.2.</span> <span class="nav-text">不适用场景</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis%E6%A6%82%E8%BF%B0%E5%AE%89%E8%A3%85"><span class="nav-number">3.</span> <span class="nav-text">Redis概述安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">4.</span> <span class="nav-text">常用数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#key%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%E6%93%8D%E4%BD%9C"><span class="nav-number">4.1.</span> <span class="nav-text">key相关命令操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#string"><span class="nav-number">4.2.</span> <span class="nav-text">string</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#list"><span class="nav-number">4.3.</span> <span class="nav-text">list</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#set"><span class="nav-number">4.4.</span> <span class="nav-text">set</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hash"><span class="nav-number">4.5.</span> <span class="nav-text">hash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#zset"><span class="nav-number">4.6.</span> <span class="nav-text">zset</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">5.</span> <span class="nav-text">配置文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis%E4%B8%AD%E7%9A%84%E5%8F%91%E5%B8%83%E5%92%8C%E8%AE%A2%E9%98%85"><span class="nav-number">6.</span> <span class="nav-text">Redis中的发布和订阅</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B0%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">7.</span> <span class="nav-text">新的数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Bitmaps"><span class="nav-number">7.1.</span> <span class="nav-text">Bitmaps</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HyperLogLog"><span class="nav-number">7.2.</span> <span class="nav-text">HyperLogLog</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Geospatial"><span class="nav-number">7.3.</span> <span class="nav-text">Geospatial</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Jedis"><span class="nav-number">8.</span> <span class="nav-text">Jedis</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B4%E5%90%88SpringBoot"><span class="nav-number">9.</span> <span class="nav-text">整合SpringBoot</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">10.</span> <span class="nav-text">事务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#redis%E6%8C%81%E4%B9%85%E5%8C%96"><span class="nav-number">11.</span> <span class="nav-text">redis持久化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#RDB"><span class="nav-number">11.1.</span> <span class="nav-text">RDB</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOF"><span class="nav-number">11.2.</span> <span class="nav-text">AOF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%8A%A3%E5%AF%B9%E6%AF%94"><span class="nav-number">11.3.</span> <span class="nav-text">优劣对比</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="nav-number">12.</span> <span class="nav-text">主从复制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9B%86%E7%BE%A4"><span class="nav-number">13.</span> <span class="nav-text">集群</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-number">14.</span> <span class="nav-text">常见问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F"><span class="nav-number">14.1.</span> <span class="nav-text">缓存穿透</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF"><span class="nav-number">14.2.</span> <span class="nav-text">缓存击穿</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9"><span class="nav-number">14.3.</span> <span class="nav-text">缓存雪崩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81"><span class="nav-number">14.4.</span> <span class="nav-text">分布式锁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B0%E5%8A%9F%E8%83%BD"><span class="nav-number">15.</span> <span class="nav-text">新功能</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%84%9F%E8%B0%A2"><span class="nav-number">16.</span> <span class="nav-text">感谢</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jie"
      src="/images/author.jpg">
  <p class="site-author-name" itemprop="name">Jie</p>
  <div class="site-description" itemprop="description">以后这样的事还多着呢</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
       
         <a href="https://github.com/a-cipher" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;a-cipher" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
       
      </span>
      <span class="links-of-author-item">
       
         <a href="mailto:a-cipher@foxmail.com" title="E-Mail → mailto:a-cipher@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
       
      </span>
      <span class="links-of-author-item">
       
         <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
       
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2021 – 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jie</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">133k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:01</span>
</div>

<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("08/01/2021 00:00:00");//此处修改你的建站时间或者网站上线时间 
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "; 
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
    } 
setInterval("createtime()",250);
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '74ASTAjyuQCIN3sUmF6NB914-gzGzoHsz',
      appKey     : '4LvGCRjICuhdKF9qaO2jYOxM',
      placeholder: "尽情说说你的想法！",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":"true#是否在手机端显示"},"log":false});</script></body>
</html>
